{
    "version": "https://jsonfeed.org/version/1",
    "title": "Chen",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2024/05/01/About-Me/",
            "url": "http://example.com/2024/05/01/About-Me/",
            "title": "About Me",
            "date_published": "2024-05-01T02:22:23.000Z",
            "content_html": "<h1 id=\"test\"><a class=\"anchor\" href=\"#test\">#</a> test</h1>\n<p>尝试给文章封面</p>\n<p>!! 黑幕黑幕黑幕黑幕黑幕黑幕！！： 鼠标滑过显示内容</p>\n<p>嘻嘻嘻</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Scanner</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ScannerTest</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">Scanner</span> scanner<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Scanner</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"请输入一个数\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">int</span> a<span class=\"token operator\">=</span>scanner<span class=\"token punctuation\">.</span><span class=\"token function\">nextInt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d的平方是%d\\n\"</span><span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>a<span class=\"token operator\">*</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#!/usr/bin/python</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">for</span> k <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span> i <span class=\"token operator\">!=</span> k <span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">!=</span> j<span class=\"token punctuation\">)</span> <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">!=</span> k<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token keyword\">print</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "http://example.com/2024/04/26/%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%E6%99%BA%E8%83%BD%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F/",
            "url": "http://example.com/2024/04/26/%E5%9F%BA%E4%BA%8E%E5%A4%A7%E6%A8%A1%E5%9E%8B%E6%9E%84%E5%BB%BA%E6%99%BA%E8%83%BD%E9%97%AE%E7%AD%94%E7%B3%BB%E7%BB%9F/",
            "title": "基于大模型构建智能问答系统",
            "date_published": "2024-04-26T02:45:42.000Z",
            "content_html": "<h1 id=\"需求\"><a class=\"anchor\" href=\"#需求\">#</a> 需求</h1>\n<p>老师：现有的 AI 还不太可控，可靠性不强，对企业来说，微调大模型意义不大。我是想在<strong>个性数据表</strong>的基础上使用 AI，把所有的数据喂给 ai 来训练，变成把现有数据整理为 20 个数据表比如人际关系表、科研工作表。提问 xxx 的手机号为多少时？不是由 AI 来回答，由 AI 来确定，上面这句话应该属于哪个表 (比如确定为人际关系表)，再从人际关系表中找出相应的信息来返回。</p>\n<p>看法：基于知识库问答？也许并不需要 &quot;整理成 20 个数据表&quot;，</p>\n<h1 id=\"学习\"><a class=\"anchor\" href=\"#学习\">#</a> 学习</h1>\n<h2 id=\"技术方案选型\"><a class=\"anchor\" href=\"#技术方案选型\">#</a> <strong>技术方案选型</strong></h2>\n<p>目前，大模型已经可以通过对自然语言的理解揣摩用户意图，并对原始知识进行汇总、整合，进而生成更具逻辑和完整性的答案。然而，仍存在以下几个问题，导致我们不能直接使用这些模型来对特定领域知识进行问答。</p>\n<ul>\n<li>专业性不足：作为通用大模型，对专业领域知识的训练不足，可能会产生幻觉以及信息丰富度不足的问题。</li>\n<li>时效性问题：模型的训练数据基于某个时间之前的数据，缺乏最新的信息，每次添加新数据都会导致高昂的训练成本。</li>\n<li>安全性问题：模型无法访问企业内部私密文档，且这些文档不能直接用于 Fine-Tuning。</li>\n</ul>\n<p>为了解决这些问题，业界采用了如下几种技术手段来为大型模型提供额外知识。</p>\n<ul>\n<li>Fine-Tuning（微调）：使用特定领域的知识对基础大模型进行微调，以改变神经网络参数的权重。虽然适用于特定任务或风格，但需要大量资源和高质量的训练数据。</li>\n<li><strong>Prompt 工程</strong>：将行业领域的知识作为输入消息提供给模型，让模型对消息中的知识进行分析和处理。这种方法在正确性和精度上表现良好，但有文本长度限制，对于大规模数据不够高效。</li>\n<li><strong>与传统搜索结合</strong>：使用传统搜索技术构建基础知识库，然后使用大语言模型处理用户请求，对召回结果进行二次加工。这种方法具有更高的可控性和效率，并适用于大规模数据。</li>\n</ul>\n<p>为了确保准确性和效率，我们选择了第 2 种和第 3 种方式相结合的方案，<strong>通过向量数据库将知识外挂作为大模型记忆体，使用 LangChain 作为基础开发框架来构建知识库问答系统，最终依靠 Prompt 工程和大模型进行交互。</strong></p>\n<h1 id=\"引用\"><a class=\"anchor\" href=\"#引用\">#</a> 引用</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82ODA3MjUxMjA=\">数据库运维工作量直接减少 50%，基于大模型构建智能问答系统的技术分享 - 知乎 (zhihu.com)</span></p>\n",
            "tags": [
                "LLM",
                "AI"
            ]
        },
        {
            "id": "http://example.com/2024/04/12/%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/",
            "url": "http://example.com/2024/04/12/%E7%AC%AC%E4%B8%80%E6%AC%A1%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87/",
            "title": "第一次面试准备",
            "date_published": "2024-04-12T04:15:51.000Z",
            "content_html": "<h1 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h1>\n<p>大概三月末的时候，学校有个招聘会，然后我投了几家。刚刚打电话，问我明早有没有时间远程面试</p>\n<p>没多想就答应了下来，这下好了，得回顾一下简历上写的东西了</p>\n<p>对的，很烂</p>\n<p><img data-src=\"image-20240412121818555.png\" alt=\"image-20240412121818555\" /></p>\n<p>想着把 Redis 看一下（其实我还没学完，当时想着做简历就写上去了，而且最近在忙着比赛和打游戏，Java 这方面已经落下很多了）</p>\n<p>也许到时候可以把面试官往我最近比赛的方面引。</p>\n<h1 id=\"可能的面试内容\"><a class=\"anchor\" href=\"#可能的面试内容\">#</a> 可能的面试内容</h1>\n<p>时间紧任务重，能准备的也不是很充分</p>\n<h2 id=\"自我介绍\"><a class=\"anchor\" href=\"#自我介绍\">#</a> <s>自我介绍</s></h2>\n<p>……</p>\n<h2 id=\"redis项目的细节\"><a class=\"anchor\" href=\"#redis项目的细节\">#</a> Redis 项目的细节 *</h2>\n<ul>\n<li>\n<p>五种类型</p>\n<p>字符串、列表、hash、set、zset</p>\n</li>\n<li>\n<p>持久化策略</p>\n<p>…</p>\n</li>\n<li>\n<p>内存淘汰策略</p>\n<p>懒惰性删除 + 定期删除，懒惰性：用的时候才查是否过期。缺点：可能会有数据一直用不到，一直存在在内存。定期删除：定期删，缺点：遍历，时间长，内存压力大</p>\n<p>结合：抽取一部分定期删除 + 懒惰</p>\n</li>\n<li>\n<p>主从、哨兵</p>\n<p>主服务器、从服务器，</p>\n<p>哨兵：监控、提醒、自动故障迁移、统一的配置管理</p>\n</li>\n<li>\n<p>其他见 <em>Redis 学习记录</em></p>\n</li>\n</ul>\n<h2 id=\"spring-boot的相关知识\"><a class=\"anchor\" href=\"#spring-boot的相关知识\">#</a> Spring boot 的相关知识</h2>\n<p><img data-src=\"image-20240412231410321.png\" alt=\"image-20240412231410321\" /></p>\n<p><img data-src=\"image-20240412231458213.png\" alt=\"image-20240412231458213\" /></p>\n<h2 id=\"最近比赛的内容\"><a class=\"anchor\" href=\"#最近比赛的内容\">#</a> 最近比赛的内容</h2>\n<p>见 <em>A25</em></p>\n<h2 id=\"git\"><a class=\"anchor\" href=\"#git\">#</a> Git</h2>\n<p><img data-src=\"image-20240412231950813.png\" alt=\"image-20240412231950813\" /></p>\n<p><img data-src=\"image-20240412232258004.png\" alt=\"image-20240412232258004\" /></p>\n<h1 id=\"面后整理\"><a class=\"anchor\" href=\"#面后整理\">#</a> 面后整理</h1>\n<h2 id=\"自我介绍-2\"><a class=\"anchor\" href=\"#自我介绍-2\">#</a> 自我介绍</h2>\n<p>阿巴阿巴</p>\n<h2 id=\"问我什么项目提升最大redis\"><a class=\"anchor\" href=\"#问我什么项目提升最大redis\">#</a> 问我什么项目提升最大（Redis）</h2>\n<p>我说了 Redis 的那个，介绍一下项目实现，因为没有开视频，我对着昨晚做的 Redis 讲 + 分布式锁</p>\n<p>（懂不懂一天速成 Redis 的含金量 后仰.jpg）</p>\n<h2 id=\"mysql\"><a class=\"anchor\" href=\"#mysql\">#</a> Mysql</h2>\n<p>索引、having、group by</p>\n<h2 id=\"mybatis配置文件\"><a class=\"anchor\" href=\"#mybatis配置文件\">#</a> MyBatis 配置文件</h2>\n<p>Mysql 配置，MyBatis 插件的配置类……</p>\n<h2 id=\"spring-boot\"><a class=\"anchor\" href=\"#spring-boot\">#</a> Spring Boot</h2>\n<p>AOP（可恶，看了的没问，没看的忘了）</p>\n<h2 id=\"java基础\"><a class=\"anchor\" href=\"#java基础\">#</a> Java 基础</h2>\n<p>ArrayList 和 LinkList 区别：</p>\n<ul>\n<li>ArrayList 基于动态数组实现的非线程安全的集合；LinkedList 基于链表实现的非线程安全的集合。</li>\n<li>对于随机 index 访问的 get 和 set 方法，一般 ArrayList 的速度要优于 LinkedList。因为 ArrayList 直接通过数组下标直接找到元素；LinkedList 要移动指针遍历每个元素直到找到为止。</li>\n</ul>\n<h2 id=\"问我什么课感兴趣\"><a class=\"anchor\" href=\"#问我什么课感兴趣\">#</a> 问我什么课感兴趣</h2>\n<p>我说了 Java + 操作系统 + 数据结构</p>\n<ul>\n<li>\n<p>操作系统</p>\n<p>银行家系统</p>\n</li>\n</ul>\n<h2 id=\"git工具\"><a class=\"anchor\" href=\"#git工具\">#</a> git 工具</h2>\n<p>常用命令</p>\n<h2 id=\"最近比赛的内容-2\"><a class=\"anchor\" href=\"#最近比赛的内容-2\">#</a> 最近比赛的内容</h2>\n<p>因为我时不时提一嘴，我最近在打比赛，然后后面终于问了。<strong>之前在牛客学的精髓，引导面试官占据主导权</strong></p>\n<p>这我可太熟了，然后问我参数的意义</p>\n<h2 id=\"由于涉及到ai问我ai对我们it行业的帮助\"><a class=\"anchor\" href=\"#由于涉及到ai问我ai对我们it行业的帮助\">#</a> 由于涉及到 AI，问我 AI 对我们 IT 行业的帮助</h2>\n<p>弱 AI，基于大数据而不是逻辑，所以只能辅助开发，而非独立开发</p>\n<h2 id=\"结尾\"><a class=\"anchor\" href=\"#结尾\">#</a> 结尾</h2>\n<p>问了一下我的情况</p>\n<h2 id=\"感想\"><a class=\"anchor\" href=\"#感想\">#</a> 感想</h2>\n<p>上次双选会，哥们就拿着之前做好的简历过去投，啥也没准备</p>\n<p>所以这一次算是第一次面试，昨天接到电话后一直在准备（虽然也玩了好些），但确实是半天速成 Redis，把敲代码的过程大部分跳了，然后关注原理，并记录。看完后昨晚看了一遍记录，今天看了一遍。</p>\n<p>然后再对着简历，准备了俩 Spring Boot 高频考点，粗看了一下 Git。早上还很早就醒了，害怕，jpg</p>\n",
            "tags": [
                "面试"
            ]
        },
        {
            "id": "http://example.com/2024/03/22/%E6%99%BA%E6%97%85%E9%97%AE%E7%AD%94/",
            "url": "http://example.com/2024/03/22/%E6%99%BA%E6%97%85%E9%97%AE%E7%AD%94/",
            "title": "智旅问答",
            "date_published": "2024-03-22T07:01:23.000Z",
            "content_html": "<h2 id=\"问题说明\"><a class=\"anchor\" href=\"#问题说明\">#</a> 问题说明</h2>\n<p>基于给定目标城市，城市可由参赛选手自己选择。通过网络、书籍等方法整理收集目标城市的文旅数据，包括但不限于<strong>城市的历史、名人、景点、饮食特色、热门店铺等信息</strong>，构建语料库，并基于大模型微调的相关技术方法，实现基于大模型的语料库问答系统。其中对于大模型的选择可以选取一些开源模型，如 GLM、modelscope 开源的 GPT-3 中文版本、LLaMA、BLOOM 等。</p>\n<p><em>此次基于 chatglm3-6b 进行微调，使用较低的配置实现较高的性能</em></p>\n<p><s><em>24/04/09 突然觉得在做无意义的事，找一段文本或者根本不找，让一个模型（copilot、kimi…）跑出些问答数据集，再塞给另一个模型微调……</em></s></p>\n<h2 id=\"期望\"><a class=\"anchor\" href=\"#期望\">#</a> 期望</h2>\n<p>基于目标城市的文旅数据，构建语料库并进行大模型的微调，实现基于大模型的语料库问答系统。通过问答系统实现用户输入以下问题，问题示例如下：</p>\n<p>请推荐 XX 城市的三个最热门的景点？</p>\n<ol>\n<li>XX 景点位于什么地方？</li>\n<li>介绍一下 XX 景点的历史？</li>\n<li>XX 附近有什么推荐的小吃店铺？</li>\n</ol>\n<p>该问答系统能够给出上述问题的回复。</p>\n<h2 id=\"要求\"><a class=\"anchor\" href=\"#要求\">#</a> 要求</h2>\n<p>收集目标城市的相关文旅数据，进行语料库的构建（方法不限），并基于语料库进行大模型微调，实现基于该语料库的问答系统。</p>\n<ol>\n<li>详细方案内容完备，具有可行性和先进性；</li>\n<li>模型支持至少两轮问答；</li>\n<li>具备大模型的基础问答能力和基于语料库的问答能力。考核方法基于用户提供的语料范围，编制问题，对模型进行提问，对模型问答能力进行评估；</li>\n<li>具有交互界面，可通过浏览器进行访问，页面的访问延迟和问答的响应延迟不超过 10s；</li>\n<li>语料库数据不低于 3000 条。</li>\n</ol>\n<h2 id=\"todo\"><a class=\"anchor\" href=\"#todo\">#</a> TODO</h2>\n<ul class=\"task-list\">\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_0\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_0\"> 语料库格式、内容</label></p>\n<p><s>（instruction + output + history + input + ？）</s></p>\n<p>查看 SHA1 码：certutil -hashfile &lt;filename&gt; SHA1</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_1\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_1\"> 使用高德地图 API 或爬点什么网站的数据或使用其他方法构建语料库</label></p>\n<p>（在建了在建了…）</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_2\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_2\"> 使用了高德地图的 API，能否使模型能调用 agent（工具），再根据返回的 json 进行回答</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_3\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_3\"> 对于<strong>城市的历史、名人、景点、饮食特色、热门店铺等信息</strong>，考虑到语聊集的格式，</label></p>\n<p><s>某某某的周边热门店铺有哪些，不太方便输入，可以考虑语聊集 + 工具调用的方法，</s></p>\n<p>好像也挺方便，比如 instruction 灵隐寺周边的奶茶店 output 古茗、一点点等……</p>\n<p>（支持多轮，如果能再问 “灵隐寺最近的古茗”，此处调用 API 回答是否能加分）</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_4\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_4\"> <s>希望能把 composition-demo 里的 chat 和 tool 结合起来，并不以 streamlit 形式输出，</s></label></p>\n<p>”Tool: 工具模式，模型除了对话外，还可以通过工具进行其他操作 “</p>\n<p>似乎不需要结合？</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_5\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_5\"> 微调 <s>p-tuning</s> | Lora | DPO |etc.</label></p>\n<p><em>24/03/30</em> Lora 微调好了，且无报错的导出了模型，但是问答效果不好，想试试 DPO</p>\n<p>​\t 04/01 开始着手微调的优化：秩 (r)、缩放系数 (alpha)：一般 alpha 是 r 的两倍</p>\n<p>​\t\t\t\t是否需要制作偏好数据集（太麻烦了，优先级低）</p>\n<p>​\t\t\t\t“微调是为了修正一些向量的参数”，但假如通过微调修改了 chatglm 的自我认知，？</p>\n<p>​\t04/02 偏好数据集，制作中！</p>\n<p>​\t\t\t\t制作好了，第一次 DPO 微调</p>\n<p>&lt;img src=&quot;image-20240402153832714.png&quot; alt=&quot;image-20240402153832714&quot; style=&quot;zoom: 67%;&quot; /&gt;</p>\n<p>​\t\t\t\t微调出来效果貌似也一般，如果想准确回答的话，不应该用过<strong>向量数据库</strong>吗（后知后觉），毕竟 chatGPT 也无法做到数据向的精准回答（增大某些词的参数吗…）</p>\n<p>​\t\t04/03 微调出了什么 **… 数据集不够大，轮数太多，导致了灾难性遗忘，只会阿巴阿巴了</p>\n<p>​\t\t\t\t\t调小轮数试试（DPO epochs3，r8，alpha16，0.15）</p>\n<p>​\t\t04/06 看看 open AI 文档 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL29wZW5haS9vcGVuYWktY29va2Jvb2svYmxvYi9tYWluL2V4YW1wbGVzL1F1ZXN0aW9uX2Fuc3dlcmluZ191c2luZ19lbWJlZGRpbmdzLmlweW5i\">Question answering using embeddings-based search</span></p>\n<p>​\t\t\t\t\t<strong>Note: To answer questions based on text documents, we recommend the procedure in</strong> <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL29wZW5haS9vcGVuYWktY29va2Jvb2svYmxvYi9tYWluL2V4YW1wbGVzL1F1ZXN0aW9uX2Fuc3dlcmluZ191c2luZ19lbWJlZGRpbmdzLmlweW5i\">Question Answering using Embeddings</span><strong>.</strong></p>\n<p>​\t\t\t\t\t推荐使用 Embedding，不涉及微调，难搞</p>\n<p><img data-src=\"image-20240406135627455.png\" alt=\"image-20240406135627455\" /></p>\n<p>​\t\t04/08 扩充一下数据集，再试着调一下</p>\n<p>​\t\t\t\t\t模型评估（loss、准确度）</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_6\" disabled=\"true\" /><label for=\"cbx_6\"> 模型评估调优、测试</label></p>\n</li>\n</ul>\n<p>​\t\t<strong>知名景点</strong></p>\n<p>​\t\t<strong>/ 小众景点</strong></p>\n<p>​\t\t<strong>不存在的景点不乱答（幻觉现象少）</strong></p>\n<ul class=\"task-list\">\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_7\" disabled=\"true\" /><label for=\"cbx_7\"> 能回答附带图片（感觉是加分项）</label></p>\n<p>conversation 里有 image 属性，似乎可以使用 / 拓展</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_8\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_8\"> 前后端联调</label></p>\n<p>24/03/30 尝试看源码，把 chatglm 提供的综合 demo 去除 streamlit</p>\n<p>​\t 03/31 fastAPI ?  似乎就 chat 而言，每次需要传输的，就是 conversation.py 里的</p>\n<p>​\t 04/01 查看了 FastAPI、uvicorn、Flask、ASGI/WSGI，<s>还是保留 streamlit（比如使用它的 session）+fastAPI 吧，好复杂（shi 山代码是如何形成的）</s></p>\n<p>​\t04/02 尝试用 FastAPI 给前端提供数据了</p>\n<p>​\t\t\t\t<s>目前看需要俩，一个是前端加载时提供一个 client；一个是 conversation 对话</s></p>\n<p>​\t\t\t\t从好几个方向写，但总感觉很卡手。无法同时部署 streamlit 和 uvicorn（FastAPI），俩服务器就不互通，数据使用起来很难受。Flask 和 streamlit 一样，是写在后端的前端界面。如果用 Vue+node.js，中间多出来的 request、response，以及前端该如何做，很陌生</p>\n<p>​\t04/03 有点混乱，简单的来看，就是前端，携带一推数据，用 get 向后端发起请求</p>\n<p>​\t\t\t\t后端收到请求后，此处对应的功能就是原代码中的 if prompt_text</p>\n<p>​\t\t\t\t需要解决的</p>\n<p>​\t\t\t\t\t<s>BaseModel 类</s>（删掉就能跑了，好神奇）</p>\n<p>​\t\t\t\t\thistory 这些参数该如何存储（json）</p>\n<p>​\t04/04 改来改去，改好了一个，</p>\n<p><img data-src=\"image-20240404105119348.png\" alt=\"image-20240404105119348\" /></p>\n</li>\n</ul>\n<p><img data-src=\"image-20240414013121762.png\" alt=\"image-20240414013121762\" /></p>\n<p><img data-src=\"image-20240414013128871.png\" alt=\"image-20240414013128871\" /></p>\n<p><img data-src=\"image-20240414013136042.png\" alt=\"image-20240414013136042\" /></p>\n<h3 id=\"后续计算机设计大赛\"><a class=\"anchor\" href=\"#后续计算机设计大赛\">#</a> 后续（计算机设计大赛）</h3>\n<ul class=\"task-list\">\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_9\" disabled=\"true\" /><label for=\"cbx_9\"> <strong>数据集优化</strong>，使之更符合自然语言 &amp; 多样化 —&gt; 微调 —&gt; 生成回答数据集 —&gt; 计算相似度<br />\n…</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_10\" disabled=\"true\" /><label for=\"cbx_10\"> 未微调过的模型 生成回答数据集 计算相似度 作为对比（前提是有<strong>高质量数据集</strong>）<br />\n…</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_11\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_11\"> <strong>加一个功能</strong>：当用户查看我们网站的内容时，为了便于浏览，用户可以通过模型输入要搜索的内容，快速找到网站中的内容</label></p>\n<p>初步解决方法：问答的函数内，放一个函数，<em>实现:</em> 先判断内容是否与网站内容有关，有则返回一个字符串 &quot;您是否在查找这个 {网站链接}&quot;，无则返回空。并拼接到此次回答中。</p>\n<p>此处的判断，&quot;与… 有关联&quot;。v1：用列表（优先级）+ 字典（键值对） [{&quot;西湖&quot;: &quot;URL&quot;}, ……]，对输入进行处理，输入包含的词是否在字典里</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_12\" disabled=\"true\" /><label for=\"cbx_12\"> <strong>加一个功能</strong>：希望在问答中能回答制定精品路线，明确关键词（如 &quot;两天&quot;、&quot;指定几个景点&quot;）<br />\n…</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_13\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_13\"> <strong>加一个语音输入</strong>：讯飞 API</label></p>\n<p>借鉴了四五年前的项目 https://github.com/Ma-Tao007/xunfei-vioceAl-vueSDK.git</p>\n<p>没想到讯飞这么早就把语音转文字免费使用了吗（500 次 / 天）</p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_14\" checked=\"true\" disabled=\"true\" /><label for=\"cbx_14\"> <strong>代码重构</strong>，去除 st<br />\n 没用到 st 的缓存什么的，只是用 st 显示，所以安全去除了</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_15\" disabled=\"true\" /><label for=\"cbx_15\"> 希望能联网（查询一些网站）<br />\n之前的痛点是如要查询旅游攻略，需要多方平台查询对比，且搜索引擎给出的链接繁多。<br />\n我们能做到联网，并统筹多方资讯，给出一个较优的回答。</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_16\" disabled=\"true\" /><label for=\"cbx_16\"> Groq 快速推理机制<br />\n…</label></p>\n</li>\n<li class=\"task-list-item\">\n<p><input type=\"checkbox\" id=\"cbx_17\" disabled=\"true\" /><label for=\"cbx_17\"> Phidata—AI 助手框架</label></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3BoaWRhdGFocS9waGlkYXRh\">https://github.com/phidatahq/phidata</span></p>\n<p>&lt;img src=&quot;image-20240428115123566.png&quot; alt=&quot;image-20240428115123566&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n</li>\n</ul>\n<hr />\n<h1 id=\"相关知识\"><a class=\"anchor\" href=\"#相关知识\">#</a> 相关知识</h1>\n<h2 id=\"peft\"><a class=\"anchor\" href=\"#peft\">#</a> PEFT</h2>\n<p>PEFT（Parameter-Efficient Fine-Tuning）是 hugging face 开源的<strong>一个参数高效微调大模型的工具</strong>，里面集成了 4 种微调大模型的方法，可以通过微调少量参数就达到接近微调全量参数的效果，使得在 GPU 资源不足的情况下也可以微调大模型。</p>\n<h2 id=\"llama-factory\"><a class=\"anchor\" href=\"#llama-factory\">#</a> llama-factory</h2>\n<p>Unify Efficient Fine-Tuning of 100+ LLMs，GitHub 上的一个统筹了<strong>支持多种大语言模型微调的工具</strong></p>\n<p><strong>项目特色</strong></p>\n<ul>\n<li>\n<p>多种模型：LLaMA、LLaVA、Mistral、Mixtral-MoE、Qwen、Yi、Gemma、Baichuan、<strong>ChatGLM</strong>、Phi 等等。</p>\n</li>\n<li>\n<p>集成方法：（增量）预训练、（多模态）指令监督微调（SFT）、奖励模型训练、PPO 训练、DPO 训练和 ORPO 训练。</p>\n</li>\n<li>\n<p>多种精度：32 比特全参数微调、16 比特冻结微调、16 比特 LoRA 微调和基于 AQLM/AWQ/GPTQ/LLM.int8 的 2/4/8 比特 QLoRA 微调。</p>\n</li>\n<li>\n<p>先进算法：GaLore、BAdam、DoRA、LongLoRA、LLaMA Pro、Mixture-of-Depths、<strong>LoRA+</strong>、LoftQ 和 Agent 微调。</p>\n</li>\n<li>\n<p>实用技巧：FlashAttention-2、Unsloth、RoPE scaling、NEFTune 和 rsLoRA。</p>\n</li>\n<li>\n<p>实验监控：LlamaBoard、TensorBoard、Wandb、MLflow 等等。</p>\n</li>\n<li>\n<p>极速推理：基于 vLLM 的 OpenAI 风格 API、浏览器界面和命令行接口。</p>\n</li>\n</ul>\n<p>于是就用这个了</p>\n<p>链接 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hpeW91Z2EvTExhTUEtRmFjdG9yeS9ibG9iL21haW4vUkVBRE1FX3poLm1k\">https://github.com/hiyouga/LLaMA-Factory/blob/main/README_zh.md</span></p>\n<h2 id=\"微调\"><a class=\"anchor\" href=\"#微调\">#</a> 微调</h2>\n<p><strong>微调这个训练不是为了准确的搜索数据库（Embeddings 才是）</strong>，微调是为了修正一些向量的参数：比方说我想写一个短视频口播文案，同样是论证观点，口播并不会像写论文等书面文案一样用严格的格式让你理解逻辑结构，所以<strong>一般口播中就不会用首先其次再次这样的说法。那么我需要通过训练把这些词的权重降低。</strong></p>\n<p>重点是<strong>方法</strong>和<strong>高质量数据集</strong></p>\n<p>微调可以分为全微调和部分微调两个方法：</p>\n<ol>\n<li>全微调（Full Fine-tuning）：全微调是指对整个预训练模型进行微调，包括所有的模型参数。在这种方法中，预训练模型的所有层和参数都会被更新和优化，以适应目标任务的需求。这种微调方法通常适用于<strong>任务和预训练模型之间存在较大差异</strong>的情况，或者<strong>任务需要模型具有高度灵活性和自适应能力</strong>的情况。Full Fine-tuning 需要较大的计算资源和时间，但可以获得更好的性能。</li>\n<li>部分微调（Repurposing）：部分微调是指在微调过程中只更新模型的顶层或少数几层，而保持预训练模型的底层参数不变。这种方法的目的是在保留预训练模型的通用知识的同时，通过微调顶层来适应特定任务。Repurposing 通常适用于目标任务与预训练模型之间<strong>有一定相似性</strong>的情况，或者<strong>任务数据集较小</strong>的情况。由于只更新少数层，Repurposing 相对于 Full Fine-tuning 需要较少的计算资源和时间，但在某些情况下性能可能会有所降低。</li>\n</ol>\n<p>从另一层次看，微调预训练模型的方法：</p>\n<ol>\n<li>微调所有层：将预训练模型的所有层都参与微调，以适应新的任务。</li>\n<li>微调顶层：只微调预训练模型的顶层，以适应新的任务。</li>\n<li>冻结底层：将预训练模型的底层固定不变，只对顶层进行微调。</li>\n<li>逐层微调：从底层开始，逐层微调预训练模型，直到所有层都被微调。</li>\n<li>迁移学习：将预训练模型的知识迁移到新的任务中，以提高模型性能。这种方法通常使用微调顶层或冻结底层的方法。</li>\n</ol>\n<h3 id=\"p-tuning和lora的区别\"><a class=\"anchor\" href=\"#p-tuning和lora的区别\">#</a> p-tuning 和 Lora 的区别</h3>\n<h4 id=\"p-tuning\"><a class=\"anchor\" href=\"#p-tuning\">#</a> p-tuning</h4>\n<p>p-tuning v2 并不是一个新技术，而是之前用于少样本学习，少样本学习分为离散型模板和连续性模板，离散性模板主要是构建文字描述模板，而连续型模板则是插入连续型 token 构成的模板，之前文章中我也讲述了离散型和连续型两种 prompt 方法。</p>\n<p>p-tuning v2 简单来说其实是 soft prompt 的一种改进，soft prompt 是只作用在 embedding 层中，实际测试下来只作用在 embedding 层的话交互能力会变弱，而且冻结模型所有参数去学习插入 token，改变量偏小使得效果有时候不太稳定，会差于微调。p-tuning v2 则不只是针对 embedding 层，而是将连续型 token 插入每一层，增大改变量和交互性。</p>\n<p><img data-src=\"image-20240330185124412.png\" alt=\"image-20240330185124412\" /></p>\n<p>soft prompt 比较依靠模型参数量，在参数量超过 10B 的模型上，效果追上了 fine-tune，但是 ptuning v2 因为每层插入了 token，增大模型训练的改变量，<strong>更加适用于小一点的模型</strong></p>\n<h4 id=\"lora\"><a class=\"anchor\" href=\"#lora\">#</a> Lora</h4>\n<p>Lora 主要在模型中注入可训练模块，大模型在预训练完收敛之后模型包含许多进行矩阵乘法的稠密层，这些层通常是满秩的，在微调过程中其实改变量是比较小的，在矩阵乘法中表现为低秩的改变，注入可训练层的目的是想下游微调的低秩改变由可训练层来学习，冻结模型其他部分，大大减少模型训练参数。</p>\n<p><img data-src=\"image-20240330185200220.png\" alt=\"image-20240330185200220\" /></p>\n<p>推理计算的时候，因为没有改变预训练权重，所以换不同的下游任务时，lora 模型保存的权重也是可以相应加载进来的，通过矩阵分解的方法参数量减少了很多，且推理时可以并行，对于推理性能并没有增加多少负担，算是比较好的低资源微调方法。</p>\n<h5 id=\"low-rank-adaptation低秩适配\"><a class=\"anchor\" href=\"#low-rank-adaptation低秩适配\">#</a> <s>Low-rank Adaptation 低秩适配:</s></h5>\n<p><s>低秩适配方法致力于将模型权重的改变限制在一个<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPSVFNCVCRCU4RSVFNyVBNyVBOSVFNSVBRCU5MCVFNyVBOSVCQSVFOSU5NyVCNCZhbXA7c2VhcmNoX3NvdXJjZT1FbnRpdHkmYW1wO2h5YnJpZF9zZWFyY2hfc291cmNlPUVudGl0eSZhbXA7aHlicmlkX3NlYXJjaF9leHRyYT0lN0IlMjJzb3VyY2VUeXBlJTIyJTNBJTIyYW5zd2VyJTIyJTJDJTIyc291cmNlSWQlMjIlM0EzMzcwNjU2MTQ3JTdE\">低秩子空间</span>内。这通常涉及对模型的权重矩阵进行分解，只微调其中的一小部分参数。这样可以有效减少计算资源的消耗，同时仍然允许模型有足够的灵活性来学习新任务。<strong>LoRA</strong> 和它的变种，如 Q-LoRA、Delta-LoRA、LoRA-FA 等，都属于这个类别。</s></p>\n<h4 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h4>\n<p><strong>共同点</strong></p>\n<p>两者对于低资源微调大模型的<strong>都是冻结大模型参数</strong>，通过小模块来学习微调产生的低秩改变。但目前存在的一些问题就是这两种训练方式很容易参数<strong>灾难性遗忘</strong>，因为模型在微调的时候整个模型层参数未改变，而少参数的学习模块微调时却是改变量巨大，容易给模型在推理时产生较大偏置，使得以前的回答能力被可学习模块带偏，在微调的时候也必须注意可学习模块不能过于拟合微调数据，否则会丧失原本的预训练知识能力，产生灾难性遗忘。</p>\n<p><strong>最好能够在微调语料中也加入通用学习语料一起微调，避免产生对微调语料极大的偏向</strong>，在 instruct gpt 论文中也提到在强化学习 ppo 的时候模型也会很容易对于 ppo 数据拟合，降低模型通用自然语言任务能力，所以在 ppo loss 中加入了 SFT 梯度和预训练梯度来缓解这种遗忘问题。</p>\n<hr />\n<p><strong>区别</strong></p>\n<ol>\n<li><strong>LoRA（Low-Rank Adaptation）</strong>：LoRA 是一种高效的参数微调技术，旨在<strong>解决过拟合</strong>问题。它通过增加一个参数来调整模型中的知识级别，使其更好地适应特定任务。虽然不需要大量带标签的数据，<strong>但可能需要更多的计算资源</strong></li>\n<li><strong>P-tuning v2</strong>：P-tuning v2 是一种改进的微调方法，它通过使用预训练模型的一部分来进行微调，而不是使用整个预训练模型。这种方法可以减少计算需求，同时提高模型性能。然而，<strong>P-tuning v2 可能需要更精细的参数调整</strong></li>\n</ol>\n<p>如果你有大量标注数据，<strong>SFT</strong>（Standard Fine-Tuning） 可能是更好的选择。对于半监督学习场景，<strong>LoRA</strong> 可能更适合。而对于防止过拟合和轻量级微调场景，<strong>Freeze</strong> 可能更合适。请根据你的需求选择最适合的方法，以优化你的模型性能。（来自 copilot）</p>\n<h3 id=\"fine-tune-a-mistral-7b-model-with-direct-preference-optimization\"><a class=\"anchor\" href=\"#fine-tune-a-mistral-7b-model-with-direct-preference-optimization\">#</a> <span class=\"exturl\" data-url=\"aHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL2ZpbmUtdHVuZS1hLW1pc3RyYWwtN2ItbW9kZWwtd2l0aC1kaXJlY3QtcHJlZmVyZW5jZS1vcHRpbWl6YXRpb24tNzA4MDQyNzQ1YWFj\">Fine-tune a Mistral-7b model with Direct Preference Optimization</span></h3>\n<p><em>hugging face 上某一榜上前三提供的一种微调方法，前提：已经经过监督式微调的模型 + 高质量偏好数据集，不知道能不能学习一下</em></p>\n<pre><code># 以下是作者提供的参数\n# LoRA configuration\npeft_config = LoraConfig(\n    r=16,\n    lora_alpha=16,\n    lora_dropout=0.05,\n    bias=&quot;none&quot;,\n    task_type=&quot;CAUSAL_LM&quot;,\n    target_modules=['k_proj', 'gate_proj', 'v_proj', 'up_proj', 'q_proj', 'o_proj', 'down_proj']\n)\n\n# Training arguments\ntraining_args = TrainingArguments(\n    per_device_train_batch_size=4,\n    gradient_accumulation_steps=4,\n    gradient_checkpointing=True,\n    learning_rate=5e-5,\n    lr_scheduler_type=&quot;cosine&quot;,\n    max_steps=200,\n    save_strategy=&quot;no&quot;,\n    logging_steps=1,\n    output_dir=new_model,\n    optim=&quot;paged_adamw_32bit&quot;,\n    warmup_steps=100,\n    bf16=True,\n    report_to=&quot;wandb&quot;,\n)\n\n# Create DPO trainer\ndpo_trainer = DPOTrainer(\n    model,\n    ref_model,\n    args=training_args,\n    train_dataset=dataset,\n    tokenizer=tokenizer,\n    peft_config=peft_config,\n    beta=0.1,\n    max_prompt_length=1024,\n    max_length=1536,\n)\n\n# Fine-tune model with DPO\ndpo_trainer.train()\n</code></pre>\n<h4 id=\"学习率的重要性\"><a class=\"anchor\" href=\"#学习率的重要性\">#</a> <strong>学习率的重要性</strong></h4>\n<p>目前深度学习使用的都是非常简单的一阶收敛算法，梯度下降法，不管有多少自适应的优化算法，本质上都是对梯度下降法的各种变形，所以初始学习率对深层网络的收敛起着决定性的作用，下面就是梯度下降法的公式</p>\n<p><img data-src=\"image-20240402154527727.png\" alt=\"image-20240402154527727\" /></p>\n<p>这里 α 就是学习率，如果学习率太小，会导致网络 loss 下降非常慢，如果学习率太大，那么参数更新的幅度就非常大，就会导致网络收敛到局部最优点，或者 loss 直接开始增加，如下图所示。</p>\n<p><img data-src=\"v2-6f1772cefad4befccd3e6cfd83b1fbfd_720w.webp\" alt=\"img\" /></p>\n<h3 id=\"大模型微调步骤\"><a class=\"anchor\" href=\"#大模型微调步骤\">#</a> 大模型微调步骤</h3>\n<p>大模型微调如上文所述有很多方法，并且对于每种方法都会有不同的微调流程、方式、准备工作和周期。然而大部分的大模型微调，都有以下几个主要步骤，并需要做相关的准备：</p>\n<ol>\n<li><strong>准备数据集</strong>：收集和准备与目标任务相关的训练数据集。确保数据集质量和标注准确性，并进行必要的数据清洗和预处理。</li>\n<li><strong>选择预训练模型 / 基础模型</strong>：根据目标任务的性质和数据集的特点，选择适合的预训练模型。</li>\n<li><strong>设定微调策略</strong>：根据任务需求和可用资源，选择适当的微调策略。考虑是进行全微调还是部分微调，以及微调的层级和范围。</li>\n<li><strong>设置超参数</strong>：确定微调过程中的超参数，如学习率、批量大小、训练轮数等。这些超参数的选择对微调的性能和收敛速度有重要影响。</li>\n<li><strong>初始化模型参数</strong>：根据预训练模型的权重，初始化微调模型的参数。对于全微调，所有模型参数都会被随机初始化；对于部分微调，只有顶层或少数层的参数会被随机初始化。</li>\n<li><strong>进行微调训练</strong>：使用准备好的数据集和微调策略，对模型进行训练。在训练过程中，根据设定的超参数和优化算法，逐渐调整模型参数以最小化<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3NlYXJjaD9xPSVFNiU4RCU5RiVFNSVBNCVCMSVFNSU4NyVCRCVFNiU5NSVCMCZhbXA7c2VhcmNoX3NvdXJjZT1FbnRpdHkmYW1wO2h5YnJpZF9zZWFyY2hfc291cmNlPUVudGl0eSZhbXA7aHlicmlkX3NlYXJjaF9leHRyYT0lN0IlMjJzb3VyY2VUeXBlJTIyJTNBJTIyYW5zd2VyJTIyJTJDJTIyc291cmNlSWQlMjIlM0EzMzcwNjU2MTQ3JTdE\">损失函数</span>。</li>\n<li><strong>模型评估和调优</strong>：在训练过程中，使用验证集对模型进行定期评估，并根据评估结果调整超参数或微调策略。这有助于提高模型的性能和泛化能力。</li>\n<li><strong>测试模型性能</strong>：在微调完成后，使用测试集对最终的微调模型进行评估，以获得最终的性能指标。这有助于评估模型在实际应用中的表现。</li>\n<li><strong>模型部署和应用</strong>：将微调完成的模型部署到实际应用中，并进行进一步的优化和调整，以满足实际需求。</li>\n</ol>\n<h4 id=\"使用llama-factory示例\"><a class=\"anchor\" href=\"#使用llama-factory示例\">#</a> 使用 LLaMA-Factory 示例</h4>\n<p><strong>数据集准备</strong></p>\n<ol>\n<li>\n<p>按照要求 LLaMA-Factory\\data\\README_zh.md 里的格式准备好数据集，格式的话，可以在生成时就按照特定格式生成，也可以后期写脚本修改成需要的格式</p>\n</li>\n<li>\n<p>在 LLaMA-Factory\\data\\dataset_info.json 把该数据集配置好 需要使用 SHA1 码。</p>\n<pre><code>certutil -hashfile &lt;filename&gt; SHA1 # 查看SHA1码\n</code></pre>\n</li>\n</ol>\n<p><strong>训练</strong></p>\n<ol>\n<li>启动 LLaMA-Factory 的 webUI</li>\n<li>设置好参数（参数可以参考下面文档调）</li>\n</ol>\n<p><strong>模型评估</strong></p>\n<ol>\n<li>训练结果好与坏可以从给出的 loss 函数来看，不震荡、收敛到 1 左右的就还行</li>\n</ol>\n<p><strong>模型调用</strong></p>\n<ol>\n<li>\n<p>可以在 webUI 的 chat 部分加载，把训练好的适配器加上后，即可调用。缺点是貌似有 bug，有时候会出现 assistant、自问自答等情况</p>\n<p>也可以导出模型，使用 chatglm 文件夹下的 demo 启动的话，缺点是导出耗时</p>\n</li>\n</ol>\n<h2 id=\"调参\"><a class=\"anchor\" href=\"#调参\">#</a> 调参</h2>\n<p>以下是 LLaMA-Factory 里，可以修改的大部分参数</p>\n<p><img data-src=\"image-20240429130319802.png\" alt=\"image-20240429130319802\" /></p>\n<p><img data-src=\"image-20240429130430005.png\" alt=\"image-20240429130430005\" /></p>\n<h3 id=\"训练阶段sft\"><a class=\"anchor\" href=\"#训练阶段sft\">#</a> 训练阶段（SFT…）</h3>\n<ul>\n<li>\n<p>SFT</p>\n<p>监督微调</p>\n</li>\n<li>\n<p>DPO</p>\n<p>直接偏好微调，一个问题 X 多个回答（优质、劣质）</p>\n</li>\n<li>\n<p>…</p>\n</li>\n</ul>\n<h3 id=\"学习率\"><a class=\"anchor\" href=\"#学习率\">#</a> 学习率</h3>\n<p>数值举例：5e-5 的计算是<strong>科学计数法</strong>中的一个数值，即 5 乘以 10 的负 5 次方，即 0.00005</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">学习率过大</th>\n<th style=\"text-align:center\">学习率过小</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">学习速度</td>\n<td style=\"text-align:center\">快</td>\n<td style=\"text-align:center\">慢</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">使用时间点</td>\n<td style=\"text-align:center\">训练开始</td>\n<td style=\"text-align:center\">一定轮数</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">副作用</td>\n<td style=\"text-align:center\">易损失值爆炸；易震荡</td>\n<td style=\"text-align:center\">易过拟合；收敛速度慢</td>\n</tr>\n</tbody>\n</table>\n<p><img data-src=\"v2-c1c72c00c93f778ad91cefb6c8a8665d_720w.webp\" alt=\"img\" /></p>\n<ol>\n<li>曲线 初始时 上扬 【红线】：<br />\nSolution：初始 学习率过大 导致 振荡，应减小学习率，并 从头 开始训练 。</li>\n<li>曲线 初始时 强势下降 没多久 归于水平 【紫线】：<br />\nSolution：后期 学习率过大 导致 无法拟合，应减小学习率，并 重新训练 后几轮 。</li>\n<li>曲线 全程缓慢 【黄线】：<br />\nSolution：初始 学习率过小 导致 收敛慢，应增大学习率，并 从头 开始训练 。</li>\n</ol>\n<p>参考链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9saW5rLnpoaWh1LmNvbS8/dGFyZ2V0PWh0dHBzJTNBLy9ibG9nLmNzZG4ubmV0L3FxXzMzNDg1NDM0L2FydGljbGUvZGV0YWlscy84MDQ1Mjk0MQ==\">深度学习：学习率 learning rate 的设定规律</span></p>\n<h3 id=\"epochs训练轮数\"><a class=\"anchor\" href=\"#epochs训练轮数\">#</a> Epochs 训练轮数</h3>\n<p>目前智旅项目的轮数都是在 3~24 轮。跟学习率、数据集等有关。轮数过多会过拟合。</p>\n<h3 id=\"最大梯度范数\"><a class=\"anchor\" href=\"#最大梯度范数\">#</a> 最大梯度范数</h3>\n<p>梯度是指损失函数对模型参数的偏导数，它表示了模型在当前参数值下的变化方向和速度。通过限制梯度的最大范数，可以控制模型参数的更新幅度，防止梯度爆炸（gradient explosion）或梯度消失（gradient vanishing）</p>\n<p>例如前面我们学的学习率，你设置一个较大的值，那极可能会梯度爆炸，你会看到曲线过山车一样！所以这个参数可以一定程度上减少这种情况！<strong>一般默认 1</strong>。</p>\n<h3 id=\"梯度累积\"><a class=\"anchor\" href=\"#梯度累积\">#</a> 梯度累积</h3>\n<p>梯度累积允许我们将多个小批次的梯度相加，然后再进行参数更新。梯度累积对于具有较大批大小的模型或具有较小 GPU 显存的情况特别有用</p>\n<p>这相当于让大模型去学习，如果一边学，一边把之前所学进行总结，通常比较累，而且需要消耗的显存也越大。如果让大模型看了 10 页书之后再总结，是不是学得更轻松些？占用的显存资源也少了。！但也会导致训练速度变慢。</p>\n<h3 id=\"计算类型fp16\"><a class=\"anchor\" href=\"#计算类型fp16\">#</a> 计算类型（FP16…）</h3>\n<p><s>FP16 是 16 位浮点数数据类型，相比于传统的 32 位浮点数（FP32），它可以减少一半的存储空间和计算开销。在混合精度训练中，模型参数和梯度可以使用 FP16 进行计算和存储，从而减少内存占用和计算时间。然而，由于 FP16 的精度较低，可能会引入一些数值精度损失，导致训练过程中的数值不够准确</s></p>\n<p><s>BF16 是一种更为近似于 FP32 的 16 位浮点数数据类型。相比于 FP16，BF16 在保持较低的存储和计算开销的同时，提供了更接近 FP32 的数值精度。因此，BF16 在混合精度训练中可以更好地平衡计算效率和数值精度。</s></p>\n<p><s>有些模型会有推荐训练方法，你只需要知道什么回事即可，默认 FP16</s></p>\n<h3 id=\"截断长度\"><a class=\"anchor\" href=\"#截断长度\">#</a> 截断长度</h3>\n<p>一条数据分词后会成为一个 token 序列，当 token 序列的长度超过截断长度时会被分割成若干段输入进模型，这里保持 1024 不变</p>\n<h3 id=\"batch-size批处理大小\"><a class=\"anchor\" href=\"#batch-size批处理大小\">#</a> <strong>Batch size</strong> (批处理大小)</h3>\n<p>一般来说，在合理的范围之内，<strong>越大的 batch size</strong> 使下降方向越准确，震荡越小；batch size 如果过大，则可能会出现局部最优的情况（这也是其中的一个缺点吧）。<strong>小的 bath size</strong> 引入的随机性更大，难以达到收敛，极少数情况下可能会效果变好。</p>\n<p>会影响训练的稳定性，Batch size 过小会使 Loss 曲线振荡的比较大，大小一般按照 2 的次幂规律选择，这是为了硬件计算效率考虑的。</p>\n<p><img data-src=\"image-20240412092213348.png\" alt=\"image-20240412092213348\" /></p>\n<p>（此处问题可能 batch size 太小了（如果学习率问题不大的话））</p>\n<p>考虑到我们的显卡，一般设置在 2~8 之间</p>\n<h3 id=\"验证集比例\"><a class=\"anchor\" href=\"#验证集比例\">#</a> 验证集比例</h3>\n<p>一般设置成 0.2</p>\n<h3 id=\"学习率调节器\"><a class=\"anchor\" href=\"#学习率调节器\">#</a> 学习率调节器</h3>\n<p>使用默认的 cosine</p>\n<h3 id=\"其他参数\"><a class=\"anchor\" href=\"#其他参数\">#</a> 其他参数</h3>\n<p>……</p>\n<h3 id=\"部分参数\"><a class=\"anchor\" href=\"#部分参数\">#</a> 部分参数</h3>\n<ul>\n<li>\n<p>可训练层数</p>\n<p>……</p>\n</li>\n<li>\n<p>可训练模块</p>\n<p>……</p>\n</li>\n</ul>\n<h3 id=\"lora参数设置\"><a class=\"anchor\" href=\"#lora参数设置\">#</a> LoRA 参数设置</h3>\n<ul>\n<li>\n<p>LoRA 秩</p>\n<p>一般为 8，是缩放系数的一半</p>\n</li>\n<li>\n<p>LoRA 缩放系数</p>\n<p>一般为 16</p>\n</li>\n<li>\n<p>随机丢弃</p>\n<p>一般设置成 0.1</p>\n</li>\n</ul>\n<h3 id=\"loss-损失函数\"><a class=\"anchor\" href=\"#loss-损失函数\">#</a> loss 损失函数</h3>\n<p>train loss 不断下降，test loss 不断下降，说明网络仍在学习；</p>\n<p>train loss 不断下降，test loss 趋于不变，说明网络过拟合；</p>\n<p>train loss 趋于不变，test loss 不断下降，说明数据集 100% 有问题；</p>\n<p>train loss 趋于不变，test loss 趋于不变，说明学习遇到瓶颈，需要减小学习率或批量数目；</p>\n<p>train loss 不断上升，test loss 不断上升，说明网络结构设计不当，训练超参数设置不当，数据集经过清洗等问题。</p>\n<h3 id=\"top-p采样-temperature温度\"><a class=\"anchor\" href=\"#top-p采样-temperature温度\">#</a> top-p 采样 /temperature 温度</h3>\n<p><strong>temperature  官网解释</strong></p>\n<p>What sampling temperature to use, between 0 and 2. Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic. We generally recommend altering this or top_p but not both.</p>\n<p>翻译：“采样温度” 是在 0 到 2 之间选择的参数。较高的值（如 0.8）会使输出更具随机性，而较低的值（如 0.2）则会使输出更集中，更确定性。通常，我们建议修改 “采样温度” 或 “top_p” 其中之一，而不是同时修改两者。</p>\n<p><strong>top-p 采样 官网解释</strong></p>\n<p>An alternative to sampling with temperature, called nucleus sampling, where the model considers the results of the tokens with top_p probability mass. So 0.1 means only the tokens comprising the top 10% probability mass are considered.</p>\n<p>翻译：&quot;nucleus sampling&quot;（核采样或者叫做 top-p 采样）是一个替代温度采样的方法，其中模型考虑了具有 top_p 概率质量的 token 的结果。因此，0.1 表示只考虑包含在最高 10% 概率质量中的 token。</p>\n<p><strong>总结</strong></p>\n<p>&quot;temperature&quot; 影响了结果的随机性，而 &quot;top_p&quot; 则影响了结果的确定性。但他们是从不同的角度影响输出的：temperature 更偏向于控制输出的 “随机性”，而 top-p 则是在给定的可能结果中设定一个 “阈值”。</p>\n<h2 id=\"文本相似度\"><a class=\"anchor\" href=\"#文本相似度\">#</a> 文本相似度</h2>\n<p>为了<strong>评估</strong>我们微调后的效果，我们引入<strong>文本相似度</strong>，而使用<strong>余弦相似度</strong>来判断文本相似度高与否</p>\n<p>初步实现：jieba 分词 + 余弦相似度 + numpy 处理 + matplotlib.pyplot 画图</p>\n<pre><code>\t# 计算平均值\n    average = sum(data) / len(data)\n    # 输出结果\n    print(&quot;平均值为:&quot;, average)\n\n    # 生成示例数据，假设这是余弦相似度的一些值\n    cosine_similarities = data  # 生成1000个随机余弦相似度值，范围在0到1之间\n\n    # 统计相似度值的频率分布\n    bins = np.linspace(0, 1, 50)  # 将x轴分为50个区间\n    hist, bins = np.histogram(cosine_similarities, bins=bins)\n\n    # 绘制频率分布图\n    plt.bar(bins[:-1], hist, width=(bins[1] - bins[0]), align='edge')\n    plt.xlabel(&quot;余弦相似度&quot;)\n    plt.ylabel(&quot;数量&quot;)\n    plt.title(&quot;余弦相似度的频率分布图&quot;)\n    plt.show()\n</code></pre>\n<h1 id=\"引用\"><a class=\"anchor\" href=\"#引用\">#</a> 引用：</h1>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuemhpaHUuY29tL3F1ZXN0aW9uLzYzODgwMzQ4OC9hbnN3ZXIvMzM3MDY1NjE0Nw==\">初学者如何对大模型进行微调？ - 爱吃牛油果的璐璐的回答 - 知乎</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM3NTc0MTg3L2FydGljbGUvZGV0YWlscy8xMzEyNDE4OTI=\">p-tuning 和 Lora 的区别_ptuning 和 lora 对比 - CSDN 博客</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly90b3dhcmRzZGF0YXNjaWVuY2UuY29tL2ZpbmUtdHVuZS1hLW1pc3RyYWwtN2ItbW9kZWwtd2l0aC1kaXJlY3QtcHJlZmVyZW5jZS1vcHRpbWl6YXRpb24tNzA4MDQyNzQ1YWFj\">Fine-tune a Mistral-7b model with Direct Preference Optimization | by Maxime Labonne | Towards Data Science</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC80MjAwNTM4MzE=\">loss 问题汇总（不收敛、震荡、nan） - 知乎 (zhihu.com)</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC82NjM0ODMxODk=\">2023 - 全网首个 (Q) Lora 微调大模型指令说明书！收藏就对了！45 天玩转大模型微调 + 知识库落地！8/45 - 知乎 (zhihu.com)</span></p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L09ubHlfQVIvYXJ0aWNsZS9kZXRhaWxzLzEzNzE0ODk1MA==\">LLaMA Factory+ModelScope 实战 —— 使用 Web UI 进行监督微调_modalscope webui 不能启动 - CSDN 博客</span></p>\n",
            "tags": [
                "AI"
            ]
        },
        {
            "id": "http://example.com/2024/02/12/supervised-learing-part01/",
            "url": "http://example.com/2024/02/12/supervised-learing-part01/",
            "title": "supervised learing part01",
            "date_published": "2024-02-12T03:05:35.000Z",
            "content_html": "<p>监督式机器学习与非监督式机器学习</p>\n<p>1. 监督学习</p>\n<ul>\n<li>\n<p>1.1 回归 regression</p>\n</li>\n<li>\n<p>1.2 分类 classification</p>\n<p>Age 和 Tumor Size 可以当做是维度，可以引入 n 维，并可以找到这 n 维度下的 O 和 X 的边界</p>\n</li>\n</ul>\n<p><img data-src=\"image-20240212112345431.png\" alt=\"image-20240212112345431\" /></p>\n<p>2. 非监督学习</p>\n<ul>\n<li>\n<p>聚类算法 clustering</p>\n<p><img data-src=\"image-20240212120641463.png\" alt=\"image-20240212120641463\" /></p>\n</li>\n</ul>\n",
            "tags": [
                "机器学习"
            ]
        },
        {
            "id": "http://example.com/2024/02/11/Long-term-Memory/",
            "url": "http://example.com/2024/02/11/Long-term-Memory/",
            "title": "Long-term Memory-机器学习01",
            "date_published": "2024-02-11T11:26:02.000Z",
            "content_html": "<p>想了解一下如何实现 GLM 的长记忆，以实现像 neuro 那样的长记忆功能。</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly95dWxsZXlpLm1lZGl1bS5jb20vbGFyZ2UtbGFuZ3VhZ2UtbW9kZWxzLWxsbS13aXRoLWxvbmctdGVybS1tZW1vcnktYWR2YW5jZW1lbnRzLWFuZC1vcHBvcnR1bml0aWVzLWluLWdlbmFpLWZjYzM1OTBmMWMwZQ==\">AI has a long-term memory problem (how to make neural networks less forgetful)</span></p>\n<pre><code>\n\n“虽然像OpenAI的GPT这样的AI模型被训练了数十亿条数据，但它们不会记住你向它们展示的任何东西，甚至不会记住它们向你返回的任何东西，”Pinecone的创始人兼首席执行官Edo Liberty说道。“AI模型是无状态的。它们没有记忆。”\n\n显然，“如果你无法回忆起任何东西，记忆就是无用的，”Liberty说。\n\n在生成AI上下文和范围的局限性\n今天许多领先的AI系统都是循环神经网络（RNNs）。这种深度学习方法使用过去的信息来提高对当前和未来输入的性能。其中最常用的之一是长短期记忆（LSTM）模型。\n\n这些模型可以处理顺序信息，并保留一定数量的先前输入的上下文以处理下一个输入，CELUS战略发展合伙人兼联合创始人André Alcalde解释道。\n\n“你可以考虑在处理句子中的单词时，这对你有多有用，”他说道。\n\n例如，你可能有些单词是从先前的单词中引用的，所以这个模型能够保持对有限数量的输入的理解。\n\n但这是关于LSTM模型的关键词：它们是有限的。\n\n简单来说，“神经网络通常是健忘的，”Gartner分析师Erick Brethenoux说道。\n\n他们“记住”了以前训练会话中的信息，并在短时间内将其考虑在内，他说。当新的训练信息进入时，模型将识别它之前见过和未见过的内容，并利用它来适应和修改。\n\n但是，如果它看到了某些东西，然后在下一个会话中没有看到它——或者在那之后的会话中也没有看到它——模型将忘记该信息。在某种意义上，模型正在考虑：“在[当前会话]之前要记住多少个会话？”\n\nAlcalde还指出，LSTM——以及RNNs一般——在实际应用中可能会遇到一些问题，比如训练过程中的指数（或消失）梯度、长时间的训练期和计算内存效率低下。\n\n“要将少量数据存储在神经网络内存中，您可能需要训练大量参数，”他解释道。\n\n更长期的AI记忆模型\nAlcalde表示，长期记忆模型可以通过使用注意力增强的LSTM或具有注意力机制的新的神经网络架构来解决这些问题。这使得模型能够更好地关注重要的上下文信息，并将其视为更重要的信息。\n\n因此，长期记忆能够更长时间地保留上下文信息，并以更节省内存的方式进行操作，从而节省计算资源，他说。这为语言模型和翻译任务提供了更好的性能，因为它们可以更好地理解正在处理的文本的上下文。\n\n“就像人类保持长期记忆一样，[模型]可以捕获并保留几个月甚至几年的上下文，”Alcalde说道。\n\n为了提高这种能力，例如，一组研究人员最近提出了他们所谓的“主动长期记忆网络”。他们将其描述为“一种能够在学习新知识的同时保持先前学习到的感官输入和行为输出之间关联的序列多任务深度学习模型”。\n\n他们写道，“在人工神经网络中进行持续学习时，当顺序学习不同任务时会出现干扰和遗忘。”\n\n增强AI记忆的矢量数据库的力量\n提高AI记忆的另一种工具是矢量数据库。\n\n正如Pinecone的Liberty所解释的，AI应用依赖于理解自然语言或图像等输入的模型。就像大脑使用化学或电神经信号传递信息一样，AI模型将它们对您展示的任何东西的理解编码为称为矢量嵌入的数字格式。\n\n但是，他说，传统的关系数据库不设计存储和搜索矢量嵌入；AI模型需要一个专门的数据库——矢量数据库——它允许开发人员搜索“这些记忆”以找到最相关的内容，Liberty说。\n\n矢量数据库存储大量的嵌入和相关元数据，例如标签或原始用户输入。然后，它使用算\n\n法对这些嵌入进行索引以进行快速检索。然后，当给定一个查询（也是嵌入的形式）时，它会迅速返回最相关的结果。\n\n“这其中的美妙之处在于搜索是通过含义而不是精确匹配完成的，因此您不需要在数据库中有任何与查询完全匹配的内容才能获得有用的答案，”Liberty说。\n\n应用含义和上下文\nLiberty表示，矢量数据库试图解决的基本问题有两个。第一个是搜索应用中缺乏意义。他指出，几十年来，工具一直依赖于将查询中的关键字与数据库中的关键字匹配。\n\n他描述的第二个问题——他将其描述为“最近的但更痛苦的”问题，因为它阻止组织实施像ChatGPT这样的高级工具——是缺乏上下文。\n\n“ChatGPT之类的解决方案可以解释和生成语言，但它生成的答案并不总是正确的，”他说道。这是一种被称为“幻觉”的现象。\n\n矢量数据库可以通过让工程师构建应用程序，该应用程序搜索嵌入而不是原始文本来解决搜索应用程序中缺乏意义的问题。这种语义搜索可以产生显著更好的结果，Liberty说。\n\n他说：“在搜索应用程序或推荐系统中，这意味着更满意的用户。”“在安全系统中，这意味着更好地检测威胁。”\n\n与此同时，矢量数据库通过让工程师存储和发现相关上下文，并将其与原始输入/问题一起提供给AI模型来解决缺乏上下文的问题。然后，AI模型将基于其对语言的理解以及“超相关”信息生成对问题的答案。\n\n“AI总是会给出答案，但不总是正确的，”他说。“当您将AI模型与用于长期记忆的矢量数据库相结合时，它会给出正确的答案。”\n\n人类化行为——而不是人类的替代品\n最终，长期记忆可以推动AI模型朝着更像人类行为的学习路径发展，Alcalde说。\n\n例如，它们可以从自己的互动中学习；记住并仅应用“消耗”的书籍、新闻、音频和视频中的重要信息块；并且具有参考这些内容的能力。\n\n但是，Brethenoux说，前进的道路应该是具有“混合学习能力”的人与机器结合。\n\nGartner提出了一个高级概念，称为“复合AI”或“混合AI”。这是“将不同的AI技术结合应用以提高学习效率，扩展知识表示水平，并最终以更有效的方式解决更广泛的业务问题。”\n\nBrethenoux指出，自然，人类有长期记忆，并且我们的大脑利用抽象、感知和上下文来做出决策。正如他所说，机器应该给我们提供一些我们可以解释和行动的东西，以共生的方式。\n\n“我希望我们不仅仅是为了自动化事物，也不仅仅是将事物呈现给人类，而是要找到更好的方法来增强智能，”他说。\n</code></pre>\n<p>[Large Language Models (LLM) with Long-Term Memory: Advancements and Opportunities in GenAI Applications](<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuc2R4Y2VudHJhbC5jb20vYXJ0aWNsZXMvYW5hbHlzaXMvYWktaGFzLWEtbG9uZy10ZXJtLW1lbW9yeS1wcm9ibGVtLWhvdy10by1tYWtlLW5ldXJhbC1uZXR3b3Jrcy1sZXNzLWZvcmdldGZ1bC8yMDIzLzAzLw==\">AI has a long-term memory problem (how to make neural networks less forgetful) - SDxCentral</span>)</p>\n<pre><code>导论\n大型语言模型（LLMs）是在大量文本库上训练的参数众多的先进机器学习模型。从技术角度来看，语言建模（LM）是推动机器语言智能进步的关键技术。LM的主要目标是开发能够准确估计生成单词序列概率的模型，从而便于估计与未来标记相关或不存在的概率。\n\n自然语言处理及相关学科的最新发展得益于大型语言模型（LLMs），如ChatGPT。研究表明，当这些模型达到一定规模时，它们会表现出新兴行为，例如具有“推理”能力。通过结合“思维链”方法，即推理示例或简单提示如“我们逐步思考”，这些模型可以通过明确的逻辑步骤回答问题。\n\n一个LLMs可以处理的例子是：“所有鲸鱼都是哺乳动物，所有哺乳动物都有肾脏；因此，所有鲸鱼都有肾脏。”这个特定的例子在研究界引起了极大的兴奋。之所以如此激动，是因为推理的能力被认为是人类智能的基本特征，而目前的人工智能系统往往被认为缺乏这种能力。\n\n尽管大型语言模型（LLMs）在特定推理任务上表现出色，但它们的通用推理能力以及它们可以参与推理过程的程度仍然存在争议。这种不确定性引发了研究界的持续辩论和不同观点。例如，有人说LLMs是“足够的零-shot推理者”，而其他作者得出的结论是“LLMs在日常规划/推理任务上仍有很长的路要走，这对人类来说并不构成挑战”。\n\n在本文中，我们开始探讨记忆在推动LLMs、一些新兴架构以及它们应用的机会中的作用。后续文章将更多地涵盖实现细节和不同方法与设计模式的具体内容。\n\n带有长期记忆的LLMs\nLLMs建立在一种称为Transformer模型的深度学习架构上。Transformer模型利用自注意机制来确定文本序列中单词或元素之间的关系。这一基础及相关发展使得模型能够更好地理解和生成具有更大上下文和连贯性的文本。\n\n为了提高LLMs的能力，研究人员考虑将长期记忆机制纳入这些模型。长期记忆允许模型在较长时间内存储信息，并在开发响应时利用这些信息。目前有两种主要方式可以将长期记忆纳入其中。\n\nLLMs可以纳入长期记忆的一种方式是利用额外的记忆组件，例如第三方数据库，包括向量数据库或（知识）图数据库。这些组件存储事实数据或嵌入，模型可以访问并用于生成文本。通过访问这些外部记忆，LLMs可以提供更精确和准确的响应。\n\n另一种方式是将记忆纳入模型本身。例如，模型可以包括一个内部记忆模块（例如索引、修改的注意机制等），在文本处理过程中存储相关数据。这种内部记忆可以被修改和访问，以影响模型的行为。通过在实际模型架构中使用长期记忆，LLMs可以展示更一致的行为，并针对给定上下文创建适当的响应。\n\n架构设计考虑因素:\n开发具有长期记忆的LLMs时必须考虑几个架构因素。一些关键考虑因素包括：\n\n存储：模型的内存应该足够大，可以存储和检索相关信息。内存组件的大小和架构必须设计为容纳预期长期数据量。\n存储更新：模型应该包括机制，以对新输入或数据进行长期记忆的修订。这确保了记忆的及时更新，并与当前上下文相关。\n记忆检索：模型需要有效的访问和检索机制，用于从长期记忆中检索信息。这个检索过程必须快速而准确，以使模型能够在文本生成过程中利用存储的信息而不会造成过多的延迟。这在使用外部记忆组件的方法中尤为重要，比如第三方数据库。\n与注意机制结合：模型的长期记忆应该与自注意机制结合。这使得模型能够在文本生成过程中关注记忆的相关部分，并根据存储的数据做出明智的决策。\n训练和选择：训练具有长期记忆的LLMs需要对记忆在训练过程中如何更新和利用有透彻的理解。为了确保有效地学习和利用存储的数据，必须采用健壮的选择技术来考虑记忆组件。\n为此，研究界出现了一些新的新兴架构，试图考虑这些设计考虑因素，同时改进成\n\n本和长期记忆效率。一个例子，如下图所示，是添加一个解耦缓存层，在训练过程中保持新鲜，以补充预训练模型。\n\n另一个例子如下图所示，是“Hyena Hierarchy”，该架构试图通过在新的稠密、无注意力架构中使用亚二次运算符来打破注意力机制的二次障碍（导致缩放成本和计算时间）。\n\n使用来自Poli等人（2023）的Hyena Hierarchy的示例架构\n\n这些新的范式以及研究和开发社区中出现的其他范式将在未来的文章中更详细地探讨。\n\nGenAI应用的进展和机会\n基于LLM的GenAI应用的发展为许多领域带来了新的机会。随着模型在理解和记忆扩展上变得越来越熟练，它们可以在越来越复杂和动态的情况下得到利用。\n\nLLMs的进展\n提高文本生成中的上下文理解和连贯性\nGenAI应用程序理解和生成具有增强上下文理解和连贯性的文本的能力是它们的重要优势之一。现代LLMs，如GPT-3.5及以上版本，已经在大量数据上进行了训练，可能会产生更恰当和与上下文相关的响应。这种改进使得跨多个应用程序进行更有意义和精确的交互成为可能。这在长期记忆机制的改进方面进一步加强，涵盖了以下领域。\n\n提高生成响应的准确性和特异性：\n将LLMs调整到获得特定领域专业知识的能力是GenAI应用程序的主要优势之一。这超越了仅仅使用现有通用LLMs的“导言”或提示工程化。通过向模型引入大量特定领域的数据并相应地调整其参数，我们可以训练它生成表现出对话题的深刻理解的响应。这种专业化使得模型能够提供更精确和与上下文相关的数据。\n\n此外，通过使用精细调整的LLMs，GenAI应用在信息检索方面表现出色。通过整合长期记忆机制，这些模型可以以更高的精度和相关性检索信息，从而使模型能够向用户查询提供更准确的结果。\n\n一致的行为和减少LLMs中的偏见：\n确保LLMs的一致性，减少LLMs中的幻觉和消除LLMs中的偏见，是具有巨大挑战的。通过在LLMs中利用更好的长期记忆机制，我们可以潜在地改善以下领域的偏见：\n\n减少偏见：AI模型从数据中获取知识。如果训练数据中包含偏见，模型也会展现出相同的偏见。因此，关键是精心策划一个平衡和多样化的训练数据集。这需要精确的数据选择和评估，以减少内在和显性偏见。更好的长期记忆可以提高输出的质量，减少幻觉并可能减少有偏见的输出。\n\n公平评估：实施和监测公正度指标可以帮助量化偏见。这些指标可以作为LLMs行为的指导原则。这其中一部分还涉及到审视LLMs在用户互动层面的输入（提示）和输出（响应）。在这方面，具有外部长期记忆机制也可能会有所帮助。在整个过程中进行定期审计和评估是识别和纠正AI系统中任何偏见的重要环节。\n\n算法透明性：大多数LLMs在决策过程中仍然非常不透明。虽然有解释性AI技术可以帮助识别内在偏见，揭示模型是如何做出决策的，但是新兴模型架构中的记忆机制也有可能提供机会，使模型更加透明。例如，可以冻结或更新模型的某些部分或其运行的长期记忆的技术可能使模型保持最新，但也确保其符合“被遗忘权”等法规而无需重新训练。\n\n机会:\n生成AI是人工智能的一个子领域，其重点是开发模型和系统以生成新的独特内容。与传统的人工智能系统相比，传统AI系统旨在识别和分类现有数据，而生成AI旨在生成新的数据，模仿其所接触的训练数据的趋势和特征。在LLMs中加强记忆功能可以显著影响以下领域：\n\n内容创作：AI在生成书面内容方面已经取得了显著进展，包括诗歌、新闻文章和技术论文。例如，企业可以使用AI生成营销文案或提供内容建议，从而极大地减少创建和修改内容的时间。此外，生成AI模型使用生成对抗网络（GANs）、变分自动编码器（VAEs）和R\n\nNN等方法来生成新的内容，如图片、视频、文本和音乐。这些模型发现了训练数据的基本模式和框架，然后利用这些信息生成具有类似特征的新样本。更长的记忆时间可以帮助基于更长的上下文演变内容，并参考以前的陈述或作品中的关键要素。\n\n个性化体验：无论是通过生成个性化购买体验还是在教育中创建独特的学习路径，生成AI都有潜力个性化我们日常生活的许多方面。改进的记忆功能将提供更好的个性化能力，可以考虑更长时间的偏好。\n\n药物发现：生成AI已经用于预测分子的潜在属性，并在药物发现中生成新的潜在药物候选物。这已经被证明可以显著加速药物发现和开发过程。更好的长期记忆可以通过包含更多关于每种分子或药物候选物的上下文信息，进一步提高这些应用的潜力。\n\n结论\n尽管有令人兴奋的发展和机会，但仍然存在重大挑战。训练这些先进LLMs的计算复杂性很高，它们的复杂性使得理解和控制它们变得更加困难。研究人员仍在探索如何有效地处理这些权衡。这个讨论的一个关键部分是LLMs和GenAI更广泛的长期记忆的作用。\n\n对这些先进的AI模型的伦理影响的关注不断增长。仍然存在未解决的隐私问题，特别是考虑到模型可以记住信息很长时间。至关重要的是，这些模型是否会记住并延续有害或有偏见的行为。\n\n研究人员、开发人员、监管机构和最终用户必须合作解决这些挑战。为了负责任地挖掘基于LLM的GenAI应用的每一种潜力，有必要开发新的方法来理解模型、AI使用的伦理标准以及更有效的隐私保护方法。\n\n总之，基于记忆和上下文的GenAI应用的快速发展代表了人工智能发展的重要里程碑。随着我们继续挑战AI可以回忆、推理和识别的界限，人类与人工智能任务之间的界限变得越来越模糊。LLMs的发展为各行各业提供了有趣的机会，但也带来了新的挑战。随着我们继续发展人工智能，前方的道路既令人兴奋又充满潜力。\n</code></pre>\n<p>上篇文章内的配图</p>\n<p><img data-src=\"0fb7O_linBXjDTysw.png\" alt=\"img\" /></p>\n<p><em>Example architecture with augmented memory mechanism from</em> <a href=\"https://arxiv.org/pdf/2306.07174.pdf\"><em>Wang et al. (2023)</em></a></p>\n<p><img data-src=\"0YJ9EjdKTiBi6ox6q.png\" alt=\"img\" /></p>\n<p><em>Example architecture using Hyena Hierarchy from</em> <a href=\"https://arxiv.org/abs/2302.10866\"><em>Poli et al. (2023)</em></a></p>\n<p>算是初步学习机器学习相关的知识，此前只听过些专有名词。</p>\n<p>但是之前就看过一些向量数据库和知识图片的文章，在看上述两篇文章之前，我就认为可以使用到类似概念的数据库来存储，</p>\n<p>“应该是修改某一部分的 “记忆”，使完成本次对话的时候，能够可能访问到该此更新。而不是携带前 n 次的 qa。”</p>\n<p>“记忆也应该有多层。”</p>\n<p>今天也看了 GLM 的<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWI2NDIxdTc0RS8/c2hhcmVfc291cmNlPWNvcHlfd2ViJmFtcDt2ZF9zb3VyY2U9ZmYyY2QxYmIyMDc2NmE2OTE5ZTJhZmM3ZmEzNjM2YTM=\"> 2024，智能体 Builder 时代，来临了吗？</span>，初步了解了大模型的架构</p>\n<p><img data-src=\"image-20240211194517900.png\" alt=\"image-20240211194517900\" /></p>\n",
            "tags": [
                "GLM"
            ]
        },
        {
            "id": "http://example.com/2024/01/27/redis%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/",
            "url": "http://example.com/2024/01/27/redis%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/",
            "title": "redis学习记录",
            "date_published": "2024-01-27T04:46:04.000Z",
            "content_html": "<p><em>大三上的寒假，玩了两周后，觉得该学一些东西了，于是在 b 站上找项目跟做，最后在鱼皮的推荐下，跟做了黑马的 redis。</em></p>\n<h3 id=\"问题1resp连接不上虚拟机上的redis\"><a class=\"anchor\" href=\"#问题1resp连接不上虚拟机上的redis\">#</a> 问题 1：RESP 连接不上虚拟机上的 redis</h3>\n<h4 id=\"搜索了csdnresp项目下的issue做了如下操作\"><a class=\"anchor\" href=\"#搜索了csdnresp项目下的issue做了如下操作\">#</a> 搜索了 CSDN，RESP 项目下的 issue，做了如下操作：</h4>\n<p>我检查了配置文件，重新按照安装说明配置了一遍 redis，都无法解决</p>\n<p>—&gt; 不是 redis 的问题</p>\n<p>我又试了试我电脑能不能 ping 上虚拟机，查找了如何获取虚拟机的 ip（ <code>ip addr</code> ），ping 成功了</p>\n<p>—&gt; 不是我电脑的问题</p>\n<p>虚拟机没学，于是我也束手无策了</p>\n<p>吃完饭后又尝试搜了一下，看了一下 <a href=\"%5B%E5%85%8D%E8%B4%B9Redis%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2%EF%BC%88RESP%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%E5%92%8C%E8%BF%9E%E6%8E%A5%E6%AD%A5%E9%AA%A4_resp%E4%B8%8B%E8%BD%BD-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/drhnb/article/details/131717836)\">免费 Redis 图形化界面（RESP）下载地址和连接步骤</a> ，发现里面有写到连接不上的问题，是 linux 的防火墙拦截了（不太懂 ping 的规则，能 ping 成功，但是防火墙会拦截）</p>\n<h4 id=\"连接不成功尝试在linux中执行下面的两个命令\"><a class=\"anchor\" href=\"#连接不成功尝试在linux中执行下面的两个命令\">#</a> 连接不成功：尝试在 linux 中执行下面的两个命令：</h4>\n<p>以下命令是用于配置 Linux 防火墙（firewalld）以开放指定的端口 （6379/tcp）。<br />\n1、</p>\n<pre><code>firewall-cmd --zone=public --add-port=6379/tcp --permanent\n</code></pre>\n<p>这个命令添加一个规则到 “public” 区域（zone）的防火墙配置中，允许通过端口 6379 的 TCP 连接。–permanent 参数表示该规则将被永久保存，重新启动后仍然有效。</p>\n<p>2、</p>\n<pre><code>firewall-cmd --reload\n</code></pre>\n<p>这个命令重新加载防火墙规则，使最新的修改生效。当你添加、删除或修改防火墙规则时，都需要执行这个命令才能使更改生效。</p>\n<p>注意事项：</p>\n<p>以上命令需要以管理员权限（例如 root 用户或者使用 sudo）来执行。<br />\n1、在执行前，请确保已经安装了 firewalld，并且正在运行。<br />\n2、6379 是 Redis 默认的端口号，如果你在使用其他端口，则需要相应地修改上述命令中的端口号。</p>\n<h3 id=\"git问题\"><a class=\"anchor\" href=\"#git问题\">#</a> git 问题</h3>\n<pre><code>F:\\HexoBlog2&gt;ssh -T git@github.com\nssh: connect to host github.com port 22: Connection timed out\n</code></pre>\n<h4 id=\"解决\"><a class=\"anchor\" href=\"#解决\">#</a> 解决</h4>\n<p>此处是端口问题，可能是被占用了或者什么的</p>\n<pre><code>$ git clone git@github.com:xxxxx/xxxx.git my-awesome-proj\nCloning into 'my-awesome-proj'...\nssh: connect to host github.com port 22: Connection timed out\nfatal: Could not read from remote repository.\n\n$ # This should also timeout\n$ ssh -T git@github.com\nssh: connect to host github.com port 22: Connection timed out\n\n$ # but this might work\n$ # 换个端口尝试，成功\n$ ssh -T -p 443 git@ssh.github.com\nHi xxxx! You've successfully authenticated, but GitHub does not provide shell access.\n\n$ # Override SSH settings\n$ # 添加一个配置文件，会读取该文件，使用配置的端口\n$ vim ~/.ssh/config\n```\n# Add section below to it\nHost github.com\n  Hostname ssh.github.com\n  Port 443\n```\n$ ssh -T git@github.com\nHi xxxxx! You've successfully authenticated, but GitHub does not\nprovide shell access.\n\n$ git clone git@github.com:xxxxxx/xxxxx.git my-awesome-proj\nCloning into 'my-awesome-proj'...\nremote: Enumerating objects: 15, done.\nremote: Counting objects: 100% (15/15), done.\nremote: Compressing objects: 100% (14/14), done.\nremote: Total 15 (delta 0), reused 15 (delta 0), pack-reused 0\nReceiving objects: 100% (15/15), 22.90 KiB | 4.58 MiB/s, done.\n</code></pre>\n<h3 id=\"记录\"><a class=\"anchor\" href=\"#记录\">#</a> 记录</h3>\n<h4 id=\"短信登陆部分\"><a class=\"anchor\" href=\"#短信登陆部分\">#</a> 短信登陆部分</h4>\n<p><img data-src=\"image-20240412122633753.png\" alt=\"image-20240412122633753\" /></p>\n<p><img data-src=\"image-20240412122758798.png\" alt=\"image-20240412122758798\" /></p>\n<p><img data-src=\"image-20240412123054149.png\" alt=\"image-20240412123054149\" /></p>\n<h4 id=\"缓存\"><a class=\"anchor\" href=\"#缓存\">#</a> 缓存</h4>\n<p><img data-src=\"image-20240412123942695.png\" alt=\"image-20240412123942695\" /></p>\n<p><img data-src=\"image-20240412124114988.png\" alt=\"image-20240412124114988\" /></p>\n<h5 id=\"缓存更新策略\"><a class=\"anchor\" href=\"#缓存更新策略\">#</a> 缓存更新策略</h5>\n<p><img data-src=\"image-20240412124326274.png\" alt=\"image-20240412124326274\" /></p>\n<p><img data-src=\"image-20240412124636426.png\" alt=\"image-20240412124636426\" /></p>\n<p>一般用第一个<img data-src=\"image-20240412124808845.png\" alt=\"image-20240412124808845\" /></p>\n<p><img data-src=\"image-20240412125028236.png\" alt=\"image-20240412125028236\" /></p>\n<h5 id=\"缓存穿透\"><a class=\"anchor\" href=\"#缓存穿透\">#</a> 缓存穿透</h5>\n<p><img data-src=\"image-20240412130240329.png\" alt=\"image-20240412130240329\" /></p>\n<h5 id=\"缓存雪崩\"><a class=\"anchor\" href=\"#缓存雪崩\">#</a> 缓存雪崩</h5>\n<p><img data-src=\"image-20240412130346583.png\" alt=\"image-20240412130346583\" /></p>\n<h5 id=\"缓存击穿\"><a class=\"anchor\" href=\"#缓存击穿\">#</a> 缓存击穿</h5>\n<p><img data-src=\"image-20240412130622535.png\" alt=\"image-20240412130622535\" /></p>\n<p><img data-src=\"image-20240412130742006.png\" alt=\"image-20240412130742006\" /></p>\n<p><img data-src=\"image-20240412130802722.png\" alt=\"image-20240412130802722\" /></p>\n<p><img data-src=\"image-20240412131031442.png\" alt=\"image-20240412131031442\" /></p>\n<p><img data-src=\"image-20240412131423996.png\" alt=\"image-20240412131423996\" /></p>\n<h4 id=\"优惠券秒杀\"><a class=\"anchor\" href=\"#优惠券秒杀\">#</a> 优惠券秒杀</h4>\n<h5 id=\"全局id生成器\"><a class=\"anchor\" href=\"#全局id生成器\">#</a> 全局 ID 生成器</h5>\n<p><img data-src=\"image-20240412140415747.png\" alt=\"image-20240412140415747\" /></p>\n<p><img data-src=\"image-20240412140436380.png\" alt=\"image-20240412140436380\" /></p>\n<h5 id=\"实现功能\"><a class=\"anchor\" href=\"#实现功能\">#</a> 实现功能</h5>\n<p><img data-src=\"image-20240412140853291.png\" alt=\"image-20240412140853291\" /></p>\n<h5 id=\"超卖问题\"><a class=\"anchor\" href=\"#超卖问题\">#</a> 超卖问题</h5>\n<p><img data-src=\"image-20240412141102576.png\" alt=\"image-20240412141102576\" /></p>\n<p><img data-src=\"image-20240412141125679.png\" alt=\"image-20240412141125679\" /></p>\n<p><img data-src=\"image-20240412141309616.png\" alt=\"image-20240412141309616\" /></p>\n<p><img data-src=\"image-20240412141410276.png\" alt=\"image-20240412141410276\" /></p>\n<h5 id=\"一人一单功能\"><a class=\"anchor\" href=\"#一人一单功能\">#</a> 一人一单功能</h5>\n<p><img data-src=\"image-20240412141516843.png\" alt=\"image-20240412141516843\" /></p>\n<h4 id=\"分布式锁\"><a class=\"anchor\" href=\"#分布式锁\">#</a> 分布式锁</h4>\n<h5 id=\"并发安全问题\"><a class=\"anchor\" href=\"#并发安全问题\">#</a> 并发安全问题</h5>\n<p>多个 JVM 的锁监视器不一样，会同时放行</p>\n<p><img data-src=\"image-20240412142353714.png\" alt=\"image-20240412142353714\" /></p>\n<h5 id=\"基于redis的分布式锁\"><a class=\"anchor\" href=\"#基于redis的分布式锁\">#</a> 基于 Redis 的分布式锁</h5>\n<p><img data-src=\"image-20240412142523089.png\" alt=\"image-20240412142523089\" /></p>\n<h5 id=\"超时释放导致误删\"><a class=\"anchor\" href=\"#超时释放导致误删\">#</a> 超时释放导致误删</h5>\n<p><img data-src=\"image-20240412144240999.png\" alt=\"image-20240412144240999\" /><br />\n<img data-src=\"image-20240412144612172.png\" alt=\"image-20240412144612172\" /></p>\n<h5 id=\"原子性问题-事务\"><a class=\"anchor\" href=\"#原子性问题-事务\">#</a> 原子性问题 （事务）</h5>\n<p><img data-src=\"image-20240412145321833.png\" alt=\"image-20240412145321833\" /></p>\n<p>解决方法</p>\n<p>用 Lua 脚本批量执行命令，达到原子性</p>\n<p><img data-src=\"image-20240412160658766.png\" alt=\"image-20240412160658766\" /></p>\n<h5 id=\"redission\"><a class=\"anchor\" href=\"#redission\">#</a> Redission</h5>\n<p><img data-src=\"image-20240412161148239.png\" alt=\"image-20240412161148239\" /></p>\n<p><img data-src=\"image-20240412161447719.png\" alt=\"image-20240412161447719\" /></p>\n<h5 id=\"使用redission的分布式锁\"><a class=\"anchor\" href=\"#使用redission的分布式锁\">#</a> 使用 Redission 的分布式锁</h5>\n<p><img data-src=\"image-20240412161535930.png\" alt=\"image-20240412161535930\" /></p>\n<p><img data-src=\"image-20240412161908045.png\" alt=\"image-20240412161908045\" /></p>\n<p><img data-src=\"image-20240412161945922.png\" alt=\"image-20240412161945922\" /></p>\n<p><img data-src=\"image-20240412162327381.png\" alt=\"image-20240412162327381\" /></p>\n<p><img data-src=\"image-20240412162658354.png\" alt=\"image-20240412162658354\" /></p>\n<p><img data-src=\"image-20240412163406408.png\" alt=\"image-20240412163406408\" /></p>\n<h4 id=\"优化优惠券秒杀\"><a class=\"anchor\" href=\"#优化优惠券秒杀\">#</a> 优化优惠券秒杀</h4>\n<p>把<strong>抢购</strong>和<strong>下单</strong>分开</p>\n<h5 id=\"基于redis优化秒杀资格判断使用lua脚本\"><a class=\"anchor\" href=\"#基于redis优化秒杀资格判断使用lua脚本\">#</a> 基于 Redis 优化秒杀资格判断（使用 Lua 脚本）</h5>\n<p><img data-src=\"image-20240412164112620.png\" alt=\"image-20240412164112620\" /></p>\n<p><img data-src=\"image-20240412164924880.png\" alt=\"image-20240412164924880\" /></p>\n<h5 id=\"基于阻塞队列优化异步下单\"><a class=\"anchor\" href=\"#基于阻塞队列优化异步下单\">#</a> 基于阻塞队列优化异步下单</h5>\n<p><img data-src=\"image-20240412164621748.png\" alt=\"image-20240412164621748\" /></p>\n<h5 id=\"问题解决消息队列\"><a class=\"anchor\" href=\"#问题解决消息队列\">#</a> 问题 &amp; 解决（消息队列）</h5>\n<p><img data-src=\"image-20240412165449807.png\" alt=\"image-20240412165449807\" /></p>\n<h4 id=\"消息队列\"><a class=\"anchor\" href=\"#消息队列\">#</a> 消息队列</h4>\n<p><img data-src=\"image-20240412180418366.png\" alt=\"image-20240412180418366\" /></p>\n<p><img data-src=\"image-20240412180446142.png\" alt=\"image-20240412180446142\" /></p>\n<p>&lt;img src=&quot;image-20240412183222085.png&quot; alt=&quot;image-20240412183222085&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<h5 id=\"redis的list模拟消息队列\"><a class=\"anchor\" href=\"#redis的list模拟消息队列\">#</a> redis 的 list 模拟消息队列</h5>\n<p>…</p>\n<h5 id=\"pubsub发布订阅\"><a class=\"anchor\" href=\"#pubsub发布订阅\">#</a> pubsub 发布订阅</h5>\n<p><img data-src=\"image-20240412181838756.png\" alt=\"image-20240412181838756\" /></p>\n<h5 id=\"stream类型消息队列\"><a class=\"anchor\" href=\"#stream类型消息队列\">#</a> STREAM 类型消息队列</h5>\n<p><img data-src=\"image-20240412182433868.png\" alt=\"image-20240412182433868\" /></p>\n<p>&lt;img src=&quot;image-20240412182643317.png&quot; alt=&quot;image-20240412182643317&quot; style=&quot;zoom:50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;image-20240412183033083.png&quot; alt=&quot;image-20240412183033083&quot; style=&quot;zoom:67%;&quot; /&gt;</p>\n<h4 id=\"功能-达人探店\"><a class=\"anchor\" href=\"#功能-达人探店\">#</a> 功能 - 达人探店</h4>\n<h5 id=\"发布\"><a class=\"anchor\" href=\"#发布\">#</a> 发布</h5>\n<p>…</p>\n<h5 id=\"查看\"><a class=\"anchor\" href=\"#查看\">#</a> 查看</h5>\n<p>…</p>\n<h5 id=\"点赞功能\"><a class=\"anchor\" href=\"#点赞功能\">#</a> 点赞功能</h5>\n<p>…</p>\n<h5 id=\"点赞排行榜\"><a class=\"anchor\" href=\"#点赞排行榜\">#</a> 点赞排行榜</h5>\n<p>在 Redis 获取 top n</p>\n<h4 id=\"功能-好友关注\"><a class=\"anchor\" href=\"#功能-好友关注\">#</a> 功能 - 好友关注</h4>\n<h5 id=\"关注取关\"><a class=\"anchor\" href=\"#关注取关\">#</a> 关注取关</h5>\n<p>…</p>\n<h5 id=\"共同关注\"><a class=\"anchor\" href=\"#共同关注\">#</a> 共同关注</h5>\n<p>把关注列表放到 redis，取交集</p>\n<h5 id=\"feed流\"><a class=\"anchor\" href=\"#feed流\">#</a> Feed 流</h5>\n<p><img data-src=\"image-20240412190422462.png\" alt=\"image-20240412190422462\" /></p>\n<p><img data-src=\"image-20240412190413921.png\" alt=\"image-20240412190413921\" /></p>\n<p>实现方案</p>\n<p><img data-src=\"image-20240412190835135.png\" alt=\"image-20240412190835135\" /></p>\n<h5 id=\"推送到粉丝收件箱\"><a class=\"anchor\" href=\"#推送到粉丝收件箱\">#</a> 推送到粉丝收件箱</h5>\n<p>…</p>\n<h5 id=\"滚动分页查询收件箱的思路\"><a class=\"anchor\" href=\"#滚动分页查询收件箱的思路\">#</a> 滚动分页查询收件箱的思路</h5>\n<p>…</p>\n<h5 id=\"实现滚动分页查询\"><a class=\"anchor\" href=\"#实现滚动分页查询\">#</a> 实现滚动分页查询</h5>\n<p>…</p>\n<h4 id=\"附近商户\"><a class=\"anchor\" href=\"#附近商户\">#</a> 附近商户</h4>\n<h5 id=\"geo数据结构\"><a class=\"anchor\" href=\"#geo数据结构\">#</a> GEO 数据结构</h5>\n<p><img data-src=\"image-20240412193025180.png\" alt=\"image-20240412193025180\" /></p>\n<h5 id=\"导入店铺数据到geo\"><a class=\"anchor\" href=\"#导入店铺数据到geo\">#</a> 导入店铺数据到 GEO</h5>\n<p>…</p>\n<h5 id=\"实现附近商户功能\"><a class=\"anchor\" href=\"#实现附近商户功能\">#</a> 实现附近商户功能</h5>\n<p>…</p>\n<p>……</p>\n",
            "tags": [
                "redis",
                "lunix",
                "git"
            ]
        },
        {
            "id": "http://example.com/2023/12/24/%E5%AE%9E%E8%AE%AD%E5%91%A8%E5%81%9A%E4%BA%86%E5%95%A5/",
            "url": "http://example.com/2023/12/24/%E5%AE%9E%E8%AE%AD%E5%91%A8%E5%81%9A%E4%BA%86%E5%95%A5/",
            "title": "实训周做了啥",
            "date_published": "2023-12-24T06:37:13.000Z",
            "content_html": "<h1 id=\"开始\"><a class=\"anchor\" href=\"#开始\">#</a> 开始</h1>\n<p>又到了实训周，之前实训周做了啥都忘记了…… 于是记录一下，表示我真的做了（</p>\n<p>老师的要求是，先用 Vue.js 做一个简单的 Todo List，有点基础后，再做一个微信小程序。</p>\n<h2 id=\"看法\"><a class=\"anchor\" href=\"#看法\">#</a> 看法</h2>\n<p>我觉得前端界面，简单一点的话，就是组件的拼装，组件自身的样式，组件和同级组件的关系，组件和父级组件的关系。</p>\n<h1 id=\"做todo-list\"><a class=\"anchor\" href=\"#做todo-list\">#</a> 做 Todo List</h1>\n<h2 id=\"npm\"><a class=\"anchor\" href=\"#npm\">#</a> npm</h2>\n<p>，用 npm 创建了项目框架。而 bootstrap 组件库也不错，有好多好看的组件供使用</p>\n<p><code>npm run dev</code></p>\n<h2 id=\"数据绑定传输等\"><a class=\"anchor\" href=\"#数据绑定传输等\">#</a> 数据绑定传输等</h2>\n<p><code>@</code> （v-on）和 <code>：</code> （v-vbind），</p>\n<pre><code>@ 用于处理事件，而 : 用于处理属性绑定。这两个符号都是Vue.js中的常见语法糖，使代码更简洁易读 \n@ 符号是 v-on 指令的缩写。它用于监听DOM事件并触发相应的Vue实例中的方法。\n: 符号是 v-bind 指令的缩写。它用于动态绑定属性或表达式\n查自chatgpt 2023/12/11\n</code></pre>\n<p>我大致理解成，@是绑定事件（函数），：是跟参数之类的有关，也就是属性</p>\n<p><code>v-model</code>  可以在组件上使用以实现双向绑定</p>\n<p><code>&#123;&#123; item.task &#125;&#125;</code>  ，可以动态获取属性的值</p>\n<p><code>@click=&quot;changeCompleted(item.id)&quot;</code> ，（）里的，可以传参，而在微信小程序里，可以用 <code>data-xxx=“”</code>  传递参数</p>\n<h2 id=\"emit的使用\"><a class=\"anchor\" href=\"#emit的使用\">#</a> $emit 的使用</h2>\n<p>起初是想在 todoList.vue 调用 App.vue 里的函数，我用的是方法是，在 todoList.vue 里导入 App.vue，然后用 <code>App.method.XXX()</code> ，结果不行，后来老师说使用 emit 什么的，并帮我找到在官方文档哪，让我自己学一下。</p>\n<p>以下摘自 Vue.js - 事件 - 事件参数</p>\n<p>有时候我们会需要在触发事件时附带一个特定的值。举例来说，我们想要  <code>&lt;BlogPost&gt;</code>  组件来管理文本会缩放得多大。在这个场景下，我们可以给  <code>$emit</code>  提供一个额外的参数：</p>\n<p>template</p>\n<pre><code>&lt;button @click=&quot;$emit('increaseBy', 1)&quot;&gt;\n  Increase by 1\n&lt;/button&gt;\n</code></pre>\n<p>然后我们在父组件中监听事件，我们可以先简单写一个内联的箭头函数作为监听器，此函数会接收到事件附带的参数：</p>\n<p>template</p>\n<pre><code>&lt;MyButton @increase-by=&quot;(n) =&gt; count += n&quot; /&gt;\n</code></pre>\n<p>或者，也可以用一个组件方法来作为事件处理函数：</p>\n<p>template</p>\n<pre><code>&lt;MyButton @increase-by=&quot;increaseCount&quot; /&gt;\n</code></pre>\n<p>该方法也会接收到事件所传递的参数：</p>\n<p>js</p>\n<pre><code>function increaseCount(n) &#123;\n  count.value += n\n&#125;\n</code></pre>\n<h2 id=\"axios的使用\"><a class=\"anchor\" href=\"#axios的使用\">#</a> axios 的使用</h2>\n<p><code>npm install axios</code></p>\n<figure class=\"highlight javascript\"><figcaption data-lang=\"javascript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">itemid</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t\t\t\t<span class=\"token comment\">// 发送 POST 请求给后端添加新任务</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t\t\taxios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:8080/todolist/removeTodolist'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t\t\t\t<span class=\"token comment\">// 参数传递</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                    \t<span class=\"token literal-property property\">id</span><span class=\"token operator\">:</span> itemid<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t\t\t\t<span class=\"token comment\">// 添加成功后，重新获取待办事项列表</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t\t\t\t<span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">$emit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fetchTodoList\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\t\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t\t\t\t<span class=\"token comment\">// 处理错误</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t\t\t\tconsole<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Error adding task:'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\t\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"后端的搭建\"><a class=\"anchor\" href=\"#后端的搭建\">#</a> 后端的搭建</h2>\n<p>老师说如果有后端能加分，我想着这不能错过啊，于是几个月前学的 java 的 Spring Boot + Mybatis plus + mysql 就派上用场了</p>\n<p>根据之前跟着做的一个项目配置好 Todo List 后端后，写了点简单的增删查改，好些用法都忘记了，悲。</p>\n<h1 id=\"做微信小程序\"><a class=\"anchor\" href=\"#做微信小程序\">#</a> 做微信小程序</h1>\n<p>想着我自己也有个公众号，做一个我也能用的上的小程序接上去。</p>\n<p>挑来挑去，做了番茄时钟和一个简单的待办。</p>\n<p>也用了 van weapp 组件库，不过用不太来。</p>\n<h2 id=\"界面样式\"><a class=\"anchor\" href=\"#界面样式\">#</a> 界面样式</h2>\n<p>&lt;img src=&quot;../../public/images/2023/12 / 番茄时钟主界面.png&quot; alt=&quot;番茄时钟主界面&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;../../public/images/2023/12 / 番茄时钟 active.png&quot; alt=&quot;番茄时钟 active&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;../../public/images/2023/12/todolist.png&quot; alt=&quot;todolist&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<p>&lt;img src=&quot;../../public/images/2023/12 / 番茄时钟 - 今日记录界面.png&quot; alt=&quot;番茄时钟 - 今日记录界面&quot; style=&quot;zoom: 50%;&quot; /&gt;</p>\n<h2 id=\"今日诗词的api\"><a class=\"anchor\" href=\"#今日诗词的api\">#</a> 今日诗词的 API</h2>\n<p>搭在 github 上的 hexo 博客也接入了这个免费的 API，需要在小程序后台添加该 API 的地址到可访问名单</p>\n<h2 id=\"界面的搭建\"><a class=\"anchor\" href=\"#界面的搭建\">#</a> 界面的搭建</h2>\n<p>直到做的差不多了，我才把大一时的前端课、近期学习的，在脑内乱成一锅粥的知识整理的差不多，也就是前端界面，简单一点的话，就是组件的拼装，组件自身的样式，组件和同级组件的关系，组件和父级组件的关系。</p>\n<h2 id=\"数据\"><a class=\"anchor\" href=\"#数据\">#</a> 数据</h2>\n<p>数据则有的放 page 的 data 里，有的放缓存里，通过 <code>wx.setStorageSync('logs', logs);</code>  和 <code>wx.getStorageSync('logs', logs);</code></p>\n",
            "tags": [
                "Vue.js",
                "微信小程序"
            ]
        },
        {
            "id": "http://example.com/2023/12/11/todolist/",
            "url": "http://example.com/2023/12/11/todolist/",
            "title": "todolist",
            "date_published": "2023-12-11T08:52:51.000Z",
            "content_html": "<p>这两周是实践周，跟着老师做点东西</p>\n<p>相对简单的是，用 vue 框架做一个简单的待办清单</p>\n<h1 id=\"步骤\"><a class=\"anchor\" href=\"#步骤\">#</a> 步骤</h1>\n<p>结合 bootstrap 框架做了如下待办清单</p>\n<p>首先用 npm 新建一个项目（需要 npm）</p>\n<pre><code>npm init vite-app todolist\n//安装需要的依赖\nnpm install\n//启动\nnpm run dev\n</code></pre>\n<p>其中，Bootstrap 需要从官方下载（可 git clone）</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3R3YnMvYm9vdHN0cmFwL3JlbGVhc2VzL2Rvd25sb2FkL3Y0LjYuMi9ib290c3RyYXAtNC42LjItZGlzdC56aXA=\">https://github.com/twbs/bootstrap/releases/download/v4.6.2/bootstrap-4.6.2-dist.zip</span></p>\n<pre><code>结构\ntodolist\n--node_modules //依赖库\n--public\n--src\n----assets //Bootstrap放这\n----components //存放部件\n------todoButton.vue //todolist的按钮\n------todoInput.vue //todolist的输入\n------todoList.vue //todolist的列表\n----App.vue // 主界面\n----index.css\n----main.js // 启动入口\n--...\n</code></pre>\n<p>todoButton.vue</p>\n<pre><code>&lt;template&gt;\n\t&lt;div class=&quot;btn-group&quot; role=&quot;group&quot; aria-label=&quot;Basic example&quot;&gt;\n\t\t&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 0 ? 'btn-primary' : btn-secondary&quot;\n\t\t\t@click=&quot;changeActive(0)&quot;&gt;全部&lt;/button&gt;\n\t\t&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 1 ? 'btn-primary' : btn-secondary&quot;\n\t\t\t@click=&quot;changeActive(1)&quot;&gt;已完成&lt;/button&gt;\n\t\t&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 2 ? 'btn-primary' : btn-secondary&quot;\n\t\t\t@click=&quot;changeActive(2)&quot;&gt;未完成&lt;/button&gt;\n\t&lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n\texport default &#123;\n\t\tname: &quot;todoButton&quot;,\n\t\tdata() &#123;\n\t\t\treturn &#123;\n\t\t\t\tactive: 0,\n\t\t\t&#125;;\n\t\t&#125;,\n\t\temits: [&quot;changeActive&quot;],\n\t\tmethods: &#123;\n\t\t\tchangeActive(index) &#123;\n\t\t\t\tthis.active = index;\n\t\t\t\tthis.$emit(&quot;changeActive&quot;, index);\n\t\t\t&#125;,\n\t\t&#125;,\n\t&#125;;\n&lt;/script&gt;\n\n&lt;style scoped&gt;\n\t.btn-group &#123;\n\t\twidth: 20%;\n\t\tmargin: 20px auto;\n\t&#125;\n&lt;/style&gt;\n</code></pre>\n<p>todoInput.vue</p>\n<pre><code>&lt;template&gt;\n\t&lt;div class=&quot;input-group mb-3&quot;&gt;\n\t\t&lt;div class=&quot;input-group-prepend&quot;&gt;\n\t\t\t&lt;button class=&quot;btn-primary&quot; @click=&quot;onsubmit&quot;&gt;提交&lt;/button&gt;\n\t\t&lt;/div&gt;\n\t\t&lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;添加任务&quot; aria-label=&quot;Username&quot; aria-describedby=&quot;basic-addon1&quot;\n\t\t\tv-model=&quot;taskname&quot;&gt;\n\t&lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n\texport default &#123;\n\t\tname: &quot;todoInput&quot;,\n\t\tdata() &#123;\n\t\t\treturn &#123;\n\t\t\t\ttaskname: &quot;&quot;,\n\t\t\t&#125;;\n\t\t&#125;,\n\t\temits: [&quot;addTask&quot;],\n\t\tmethods: &#123;\n\t\t\tonsubmit() &#123;\n\t\t\t\tthis.$emit(&quot;addTask&quot;, this.taskname);\n\t\t\t\tthis.taskname = &quot;&quot;;\n\t\t\t&#125;\n\t\t&#125;,\n\t&#125;;\n&lt;/script&gt;\n\n&lt;style scoped&gt;\n\t.input-group &#123;\n\t\twidth: 40%;\n\t\tmargin: 20px auto;\n\t&#125;\n&lt;/style&gt;\n</code></pre>\n<p>todoList.vue</p>\n<pre><code>&lt;template&gt;\n\t&lt;ul class=&quot;list-group&quot;&gt;\n\t\t&lt;li class=&quot;list-group-item d-flex justify-content-between align-items-center&quot; v-for=&quot;item in todolist&quot; :\n\t\t\tkey=&quot;item.id&quot;&gt;\n\t\t\t&lt;!-- 复选框 --&gt;\n\t\t\t&lt;div class=&quot;form-check&quot;&gt;\n\t\t\t\t&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;item.id&quot; v-model=&quot;item.isCompleted&quot;&gt;\n\t\t\t\t&lt;label class=&quot;form-check-label&quot; :for=&quot;item.id&quot; :class=&quot;item.isCompleted ? 'delete' : ''&quot;&gt;\n\t\t\t\t\t&#123;&#123; item.task &#125;&#125;\n\t\t\t\t&lt;/label&gt;\n\t\t\t&lt;/div&gt;\n\t\t\t&lt;span class=&quot;badge badge-success badge-pill&quot; v-if=&quot;item.isCompleted&quot;&gt;已完成&lt;/span&gt;\n\t\t\t&lt;span class=&quot;badge badge-warning badge-pill&quot; v-else&gt;未完成&lt;/span&gt;\n\t\t&lt;/li&gt;\n\t&lt;/ul&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n\texport default &#123;\n\t\tname: 'todoList',\n\t\tprops: &#123;\n\t\t\ttodolist: &#123;\n\t\t\t\ttype: Array,\n\t\t\t\trequired: true,\n\t\t\t\tdefault: [],\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;\n&lt;/script&gt;\n\n&lt;style scoped&gt;\n\t.list-group &#123;\n\t\twidth: 40%;\n\t\tmargin: 20px auto;\n\t&#125;\n\n\t.delete &#123;\n\t\ttext-decoration: line-through;\n\t&#125;\n&lt;/style&gt;\n</code></pre>\n<p>App.vue</p>\n<pre><code>&lt;template&gt;\n\t&lt;div id=&quot;app&quot;&gt;\n\t\t&lt;h1&gt;TodoList&lt;/h1&gt;\n\t\t&lt;h6&gt;edit by Chen&lt;/h6&gt;\n\t\t&lt;!-- @ 用于处理事件，而 : 用于处理属性绑定。这两个符号都是Vue.js中的常见语法糖，使代码更简洁易读 --&gt;\n\t\t&lt;!-- @ 符号是 v-on 指令的缩写。它用于监听DOM事件并触发相应的Vue实例中的方法。 --&gt;\n\t\t&lt;!-- : 符号是 v-bind 指令的缩写。它用于动态绑定属性或表达式 --&gt;\n\t\t&lt;!-- 查自chatgpt 2023/12/11 --&gt;\n\t\t&lt;todoInput @addTask=&quot;addTask&quot;&gt;&lt;/todoInput&gt;\n\t\t&lt;todoList :todolist=&quot;todoList&quot;&gt;&lt;/todoList&gt;\n\t\t&lt;todoButton @changeActive=&quot;changeActive&quot;&gt;&lt;/todoButton&gt;\n\t&lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\n\timport todoList from './components/todoList.vue'\n\timport todoButton from './components/todoButton.vue'\n\timport todoInput from './components/todoInput.vue'\n\n\texport default &#123;\n\t\tname: &quot;App&quot;,\n\t\tdata() &#123;\n\t\t\treturn &#123;\n\t\t\t\t// 假数据\n\t\t\t\ttodoList: [&#123;\n\t\t\t\t\t\tid: 1,\n\t\t\t\t\t\ttask: '吃饭',\n\t\t\t\t\t\tisCompleted: true\n\t\t\t\t\t&#125;,\n\t\t\t\t\t&#123;\n\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\ttask: '嘻嘻嘻',\n\t\t\t\t\t\tisCompleted: false\n\t\t\t\t\t&#125;,\n\t\t\t\t\t&#123;\n\t\t\t\t\t\tid: 3,\n\t\t\t\t\t\ttask: 'zzzzzzzz',\n\t\t\t\t\t\tisCompleted: true\n\t\t\t\t\t&#125;,\n\t\t\t\t],\n\t\t\t\tactive: 0,\n\t\t\t&#125;;\n\t\t&#125;,\n\t\tcomputed: &#123;\n\t\t\ttodoList() &#123;\n\t\t\t\tif (this.active === 0) &#123;\n\t\t\t\t\treturn this.todoList;\n\t\t\t\t&#125; else if (this.active === 1) &#123;\n\t\t\t\t\treturn this.todoList.filter(item =&gt; item.isCompleted);\n\t\t\t\t&#125; else &#123;\n\t\t\t\t\treturn this.todoList.filter(item =&gt; !item.isCompleted);\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t&#125;,\n\t\tmethods: &#123;\n\t\t\tchangeActive(active) &#123;\n\t\t\t\tthis.active = active;\n\t\t\t\tconsole.log(this.active);\n\t\t\t&#125;,\n\t\t\taddTask(taskname) &#123;\n\t\t\t\tthis.todoList.push(&#123;\n\t\t\t\t\tid: this.todoList.length + 1,\n\t\t\t\t\ttask: taskname,\n\t\t\t\t\tisCompleted: false,\n\t\t\t\t&#125;)\n\t\t\t&#125;,\n\t\t&#125;,\n\t\tcomponents: &#123;\n\t\t\ttodoList,\n\t\t\ttodoButton,\n\t\t\ttodoInput\n\t\t&#125;\n\t&#125;\n&lt;/script&gt;\n</code></pre>\n<p>main.vue</p>\n<pre><code>import &#123; createApp &#125; from 'vue'\nimport App from './App.vue'\nimport './assets/css/bootstrap.css'\nimport './index.css'\n\ncreateApp(App).mount('#app')\n\n</code></pre>\n",
            "tags": [
                "vue3"
            ]
        },
        {
            "id": "http://example.com/2023/11/07/leetcodeDP/",
            "url": "http://example.com/2023/11/07/leetcodeDP/",
            "title": "“leetcodeDP”",
            "date_published": "2023-11-07T11:52:00.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy90cmlhbmdsZS8=\">120. 三角形最小路径和</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">minimumTotal</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> triangle<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span>List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\"># [2],</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token comment\"># [3,4],</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\"># [6,5,7],</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\"># [4,1,8,3]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\"># dp[k][i] += min(dp[k-1][i-1], dp[k-1][i])</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>triangle<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            m <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">if</span> j <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>                    triangle<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> triangle<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                <span class=\"token keyword\">elif</span> j <span class=\"token operator\">==</span> m<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                    triangle<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> triangle<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>                    triangle<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>triangle<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> triangle<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>triangle<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9taW5pbXVtLXBhdGgtc3VtLw==\">64. 最小路径和</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">minPathSum</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> grid<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span>List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>grid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        m <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>grid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\"># 每次只能向下或者向右移动一步</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token comment\"># -> dp[next] = min(dp[left], dp[up]) + dp[i]</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\"># 第一行只能从左往右，第一列只能从上往下</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            grid<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> grid<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            grid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> grid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>                grid<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">+=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>grid<span class=\"token punctuation\">[</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> grid<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> grid<span class=\"token punctuation\">[</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>m<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy91bmlxdWUtcGF0aHMtaWkv\">63. 不同路径 II</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">uniquePathsWithObstacles</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> obstacleGrid<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span>List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        n <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>obstacleGrid<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        m <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>obstacleGrid<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token decorator annotation punctuation\">@cache</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">def</span> <span class=\"token function\">dfs</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token comment\"># 如果到达右下角且右下角不为 1，则当前路线有效</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token keyword\">if</span> i <span class=\"token operator\">==</span> n<span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">and</span> j <span class=\"token operator\">==</span> m<span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">and</span> obstacleGrid<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token comment\"># 如果越界或者碰到阻碍，则无效</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">if</span> i <span class=\"token operator\">>=</span> n <span class=\"token keyword\">or</span> j <span class=\"token operator\">>=</span> m <span class=\"token keyword\">or</span> obstacleGrid<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token comment\"># 返回 向左走向下走</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">return</span> dfs<span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> dfs<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span> j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">return</span> dfs<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "dp"
            ]
        },
        {
            "id": "http://example.com/2023/11/01/leetcode369/",
            "url": "http://example.com/2023/11/01/leetcode369/",
            "title": "leetcode369",
            "date_published": "2023-11-01T14:00:47.000Z",
            "content_html": "<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9maW5kLXRoZS1rLW9yLW9mLWFuLWFycmF5Lw==\">2917. 找出数组中的 K-or 值</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">findKOr</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> nums<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\"># 位运算</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        ans <span class=\"token operator\">=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token comment\"># num &lt; 2^31, i 是第 i 位</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">31</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            cnt <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token comment\"># 所有数的二进制的第 i 位是否为 1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">for</span> num <span class=\"token keyword\">in</span> nums<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token keyword\">if</span> num <span class=\"token operator\">>></span> i <span class=\"token operator\">&amp;</span> <span class=\"token number\">1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>                    cnt <span class=\"token operator\">+=</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            <span class=\"token comment\"># 满足条件，加</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">if</span> cnt <span class=\"token operator\">>=</span> k<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>                ans <span class=\"token operator\">|</span><span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token operator\">&lt;&lt;</span> i</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">return</span> ans</pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9taW5pbXVtLWVxdWFsLXN1bS1vZi10d28tYXJyYXlzLWFmdGVyLXJlcGxhY2luZy16ZXJvcy8=\">2918. 数组的最小相等和</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">minSum</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> nums1<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> nums2<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        sum1 <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>nums1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        cnt1 <span class=\"token operator\">=</span> nums1<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        sum2 <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>nums2<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        cnt2 <span class=\"token operator\">=</span> nums2<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">if</span> cnt1<span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> cnt2<span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> sum1 <span class=\"token operator\">!=</span> sum2 <span class=\"token keyword\">or</span> cnt1<span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> sum2 <span class=\"token operator\">+</span> cnt2<span class=\"token operator\">></span>sum1 <span class=\"token keyword\">or</span> cnt2<span class=\"token operator\">==</span><span class=\"token number\">0</span> <span class=\"token keyword\">and</span> sum1 <span class=\"token operator\">+</span> cnt1<span class=\"token operator\">></span>sum2<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>sum1<span class=\"token operator\">+</span>cnt1<span class=\"token punctuation\">,</span> sum2<span class=\"token operator\">+</span>cnt2<span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZWV0Y29kZS5jbi9wcm9ibGVtcy9taW5pbXVtLWluY3JlbWVudC1vcGVyYXRpb25zLXRvLW1ha2UtYXJyYXktYmVhdXRpZnVsLw==\">2919. 使数组变美的最小增量运算数</span></p>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Solution</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token keyword\">def</span> <span class=\"token function\">minIncrementOperations</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> nums<span class=\"token punctuation\">:</span> List<span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> k<span class=\"token punctuation\">:</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">#python3 注解，记忆化搜索，其他语言可用 visit [] 数组记录</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token decorator annotation punctuation\">@cache</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token keyword\">def</span> <span class=\"token function\">dp</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">:</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">:</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token keyword\">if</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token comment\"># 不选</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            res <span class=\"token operator\">=</span> dp<span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>  <span class=\"token operator\">+</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>k<span class=\"token operator\">-</span>nums<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>            <span class=\"token comment\"># 选</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token keyword\">if</span> j <span class=\"token operator\">&lt;</span> <span class=\"token number\">2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>                res <span class=\"token operator\">=</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> dp<span class=\"token punctuation\">(</span>i<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> j<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            <span class=\"token keyword\">return</span> res</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">return</span> dp<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>nums<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure>",
            "tags": [
                "dp",
                "位运算",
                "分类讨论"
            ]
        },
        {
            "id": "http://example.com/2023/10/23/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F01/",
            "url": "http://example.com/2023/10/23/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F01/",
            "title": "设计模式01",
            "date_published": "2023-10-23T07:03:19.000Z",
            "content_html": "<p>跟着该视频做的一个笔记<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMUc0NDExYzdONA==\">尚硅谷 Java 设计模式（图解 + 框架源码剖析）</span></p>\n<h1 id=\"设计模式\"><a class=\"anchor\" href=\"#设计模式\">#</a> 设计模式</h1>\n<h2 id=\"1设计模式的目的\"><a class=\"anchor\" href=\"#1设计模式的目的\">#</a> 1 设计模式的目的</h2>\n<p>编写软件过程中，程序员面临着来自<strong>耦合性，内聚性以及可维护性，可扩展性，重用性，灵活性</strong>等多方面的挑战，设计模式是为了让程序 (软件)，具有更好的</p>\n<ul>\n<li>代码重用性 (即：相同功能的代码，不用多次编写)</li>\n<li>可读性 (即：编程规范性，便于其他程序员的阅读和理解)</li>\n<li>可扩展性 (即：当需要增加新的功能时，非常的方便，称为可维护)</li>\n<li>可靠性 (即：当我们增加新的功能后，对原来的功能没有影响)</li>\n</ul>\n<p>使程序呈现<strong>高内聚，低耦合</strong>的特性</p>\n<h2 id=\"2设计模式七大原则\"><a class=\"anchor\" href=\"#2设计模式七大原则\">#</a> 2 设计模式七大原则</h2>\n<p>设计模式原则，其实就是程序员在编程时，应当遵守的原则，也是各种设计模式的基础 (即：设计模式为什么这样设计的依据)</p>\n<p>设计模式常用的七大原则有:</p>\n<h3 id=\"21-单一职责原则single-responsibility-principle\"><a class=\"anchor\" href=\"#21-单一职责原则single-responsibility-principle\">#</a> 2.1 单一职责原则（Single Responsibility Principle）</h3>\n<ul>\n<li>降低类的复杂度，一个类只负责一项职责</li>\n<li>提高类的可读性，可维护性，降低变更引起的风险</li>\n<li>通常情况下，我们应当遵守单一职责原则，只有逻辑足够简单，才可以在代码级违反单一职责原则；只有类中方法数量足够少，可以在方法级别保持单一职责原则</li>\n</ul>\n<p>对类来说的，即一个类应该只负责<strong>一项职责</strong>。如类 A 负责两个不同职责：职责 1，职责 2。当职责 1 需求变更而改变 A 时，可能造成职责 2 执行错误，所以需要将类 A 的粒度分解为 A1，A2</p>\n<h3 id=\"22接口隔离原则interface-segregation-principle\"><a class=\"anchor\" href=\"#22接口隔离原则interface-segregation-principle\">#</a> 2.2 接口隔离原则（Interface Segregation Principle）</h3>\n<p>客户端不应该依赖它不需要的接口，即一个类对另一个类的依赖应该建立在最小的接口上</p>\n<p>也就是说接口要细拆分，类只需要实现相关的接口，不需要实现用不到的</p>\n<h3 id=\"23依赖倒转倒置原则dependence-inversion-principle\"><a class=\"anchor\" href=\"#23依赖倒转倒置原则dependence-inversion-principle\">#</a> 2.3 依赖倒转 (倒置) 原则（Dependence Inversion Principle）</h3>\n<ul>\n<li>高层模块不应该依赖低层模块，二者都应该依赖其抽象</li>\n<li>抽象不应该依赖细节，细节应该依赖抽象</li>\n<li>依赖倒转 (倒置) 的中心思想是面向接口编程</li>\n<li>依赖倒转原则是基于这样的设计理念：相对于细节的多变性，抽象的东西要稳定的多。以抽象为基础搭建的架构比以细节为基础的架构要稳定的多。在 java 中，抽象指的是接口或抽象类，细节就是具体的实现类</li>\n<li>使用接口或抽象类的目的是制定好规范，而不涉及任何具体的操作，把展现细节的任务交给他们的实现类去完成</li>\n</ul>\n<p>依赖倒转原则的注意事项和细节</p>\n<ul>\n<li><strong>低层模块尽量都要有抽象类或接口</strong>，或者两者都有，程序稳定性更好，最好不要一个类孤零零的</li>\n<li>变量的声明类型尽量是抽象类或接口，这样我们的变量引用和实际对象间，就存在一个<strong>缓冲层</strong>，利于程序扩展和优化</li>\n<li>继承时遵循里氏替换原则</li>\n</ul>\n<h3 id=\"24里氏替换原则liskov-substitution-principle\"><a class=\"anchor\" href=\"#24里氏替换原则liskov-substitution-principle\">#</a> 2.4 里氏替换原则（Liskov Substitution Principle）</h3>\n<blockquote>\n<p>OO 中的继承性的思考和说明：</p>\n<p>继承包含这样一层含义：父类中凡是已经实现好的方法，实际上是在设定规范和契约，虽然它不强制要求所有的子类必须遵循这些契约，但是如果子类对这些已经实现的方法任意修改，就会对整个继承体系造成破坏。</p>\n<p>继承在给程序设计带来便利的同时，也带来了弊端。比如使用继承会给程序带来侵入性，程序的可移植性降低，增加对象间的耦合性，如果一个类被其他的类所继承则当这个类需要修改时，必须考虑到所有的子类，并且父类修改后，所有涉及到子类的功能都有可能产生故障</p>\n<p>问题提出：在编程中，<strong>如何正确的使用继承</strong>？=&gt; 里氏替换原则</p>\n</blockquote>\n<p>在使用继承时，遵循里氏替换原则，在<strong>子类中尽量不要重写父类的方法</strong></p>\n<p>里氏替换原则告诉我们，继承实际上让两个类耦合性增强了，在适当的情况下，可以通过聚合，组合，依赖来解决问题。</p>\n<h3 id=\"25开闭原则open-closed-principle\"><a class=\"anchor\" href=\"#25开闭原则open-closed-principle\">#</a> 2.5 开闭原则 (Open Closed Principle)</h3>\n<p>开闭原则是编程中<em><strong>最基础、最重要</strong></em>的设计原则</p>\n<p>一个软件实体如类、模块和函数应该对扩展开放 (对提供方)，对修改关闭 (对使用方)。用抽象构建框架，用实扩展细节。</p>\n<p>当软件需要变化时，尽量通过扩展软件实体的行为来实现变化，而不是通过修改已有的代码来实现变化</p>\n<h3 id=\"26迪米特法则demeter-principle\"><a class=\"anchor\" href=\"#26迪米特法则demeter-principle\">#</a> 2.6 迪米特法则（Demeter Principle）</h3>\n<p>迪米特法则的核心是降低类之间的耦合。由于每个类都减少了不必要的依赖，因此迪米特法则只是要求降低类间 (对象间) 耦合关系， 并不是要求完全没有依赖关系</p>\n<p>迪米特法则又叫<strong>最少知道原则</strong>，即一个类对自己依赖的类知道的越少越好。也就是说，对于被依赖的类不管多么复杂，都尽量将逻辑封装在类的内部。对外除了提供的 public 方法，不对外泄露任何信息。迪米特法则还有个更简单的定义：只与直接的朋友通信</p>\n<p>直接的朋友：每个对象都会与其他对象有耦合关系，只要两个对象之间有耦合关系，我们就说这两个对象之间是朋友关系。耦合的方式很多，依赖，关联，组合，聚合等。其中，我们称出现成员变量、方法参数、方法返回值中的类为直接的朋友，而出现在局部变量中的类不是直接的朋友。也就是说，陌生的类最好不要以局部变量的形式出现在类的内部。</p>\n<h3 id=\"27合成复用原则composite-reuse-principle\"><a class=\"anchor\" href=\"#27合成复用原则composite-reuse-principle\">#</a> 2.7 合成复用原则 (Composite Reuse Principle)</h3>\n<p>原则是尽量使用合成 / 聚合的方式，而不是使用继承</p>\n<p><img data-src=\"image-20240301154812906.png\" alt=\"\" /></p>\n<h3 id=\"28设计模式的原则核心\"><a class=\"anchor\" href=\"#28设计模式的原则核心\">#</a> 2.8 设计模式的原则核心</h3>\n<p>找出应用中可能需要变化之处，把它们独立出来，不要和那些不需要变化的代码混在一起。</p>\n<p>针对接口编程，而不是针对实现编程。</p>\n<p>为了交互对象之间的松耦合设计而努力。</p>\n<h2 id=\"3uml类图\"><a class=\"anchor\" href=\"#3uml类图\">#</a> 3.UML 类图</h2>\n<h3 id=\"31基本介绍\"><a class=\"anchor\" href=\"#31基本介绍\">#</a> 3.1 基本介绍</h3>\n<p><img data-src=\"image-20240301155116451.png\" alt=\"image-20240301155116451\" /></p>\n<h3 id=\"32类图分类\"><a class=\"anchor\" href=\"#32类图分类\">#</a> 3.2 类图分类</h3>\n<ol>\n<li>用例图（use case）</li>\n<li>静态结构图: <strong>类图</strong>、对象图、包图、组件图、部署图</li>\n<li>动态行为图：交互图 (时序图与协作图)、状态图、活动图</li>\n</ol>\n<h3 id=\"33类之间的关系\"><a class=\"anchor\" href=\"#33类之间的关系\">#</a> 3.3 类之间的关系</h3>\n<p>依赖、泛化（继承）、实现、关联、聚合、组合</p>\n<h4 id=\"依赖\"><a class=\"anchor\" href=\"#依赖\">#</a> 依赖</h4>\n<p>只要类中用到了对方，则构成依赖关系</p>\n<p>类成员属性、方法返回类型、方法参数接受的参数类型、方法中使用到</p>\n<h4 id=\"泛化继承\"><a class=\"anchor\" href=\"#泛化继承\">#</a> 泛化（继承）</h4>\n<p>继承，依赖关系的特例</p>\n<h4 id=\"实现\"><a class=\"anchor\" href=\"#实现\">#</a> 实现</h4>\n<p>接口实现，依赖关系的特例</p>\n<h4 id=\"关联\"><a class=\"anchor\" href=\"#关联\">#</a> 关联</h4>\n<p>类与类之间的联系，依赖关系的特例</p>\n<h4 id=\"聚合\"><a class=\"anchor\" href=\"#聚合\">#</a> 聚合</h4>\n<p>表示整体和部分的关系，整体和部分能分开，关联关系特例（private A；）</p>\n<p>如果不能分开，则升级为组合关系（private A = new A（）；）</p>\n<h4 id=\"组合\"><a class=\"anchor\" href=\"#组合\">#</a> 组合</h4>\n<p>整体和部分不能分开</p>\n<h2 id=\"4设计模式概述\"><a class=\"anchor\" href=\"#4设计模式概述\">#</a> 4. 设计模式概述</h2>\n<p>设计模式分为三种类型，共 23 种（？）</p>\n<ol>\n<li><strong>创建型模式</strong>：&lt;u&gt; 单例模式 &lt;/u&gt;、抽象工厂模式、原型模式、建造者模式、&lt;u &gt; 工厂模式 &lt;/u&gt;</li>\n<li><strong>结构型模式</strong>：适配器模式、桥接模式、&lt;u&gt; 装饰模式 &lt;/u&gt;、组合模式、外观模式、享元模式、&lt;u &gt; 代理模式 &lt;/u&gt;</li>\n<li><strong>行为型模式</strong>：模版方法模式、命令模式、访问者模式、迭代器模式、&lt;u&gt; 观察者模式 &lt;/u&gt;、中介者模式、备忘录模式、解释器模式 (Interpreter 模式)、状态模式、策略模式、职责链模式 (责任链模式)</li>\n</ol>\n<h3 id=\"单例模式\"><a class=\"anchor\" href=\"#单例模式\">#</a> 单例模式</h3>\n<p>单例模式有八种方式</p>\n<h4 id=\"饿汉式静态常量\"><a class=\"anchor\" href=\"#饿汉式静态常量\">#</a> 饿汉式 (静态常量)</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 饿汉式（静态变量）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 用之前就创建</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 构造器私有化，外部不能 new</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// 本类内部创建对象实例</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Singleton</span> instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token comment\">// 提供一个公有的静态方法，返回对象实例</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Singleton</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>避免了线程同步问题，但是没实现懒加载，<strong>可能</strong>会造成内存浪费</p>\n<h4 id=\"饿汉式静态代码块\"><a class=\"anchor\" href=\"#饿汉式静态代码块\">#</a> 饿汉式 (静态代码块)</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>……</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 静态代码块</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>……</pre></td></tr></table></figure><h4 id=\"懒汉式线程不安全\"><a class=\"anchor\" href=\"#懒汉式线程不安全\">#</a> 懒汉式 (线程不安全)</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton02</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 构造器私有化，外部不能 new</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Singleton02</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Singleton02</span> instance<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">// 提供一个静态的公有方法，当使用到该方法时，才去创建</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">// 饿汉模式</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">//synchronized, 解决线程同步问题，但是效率低，后续获取都要进行同步</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Singleton02</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>instance <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton02</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"懒汉式线程安全同步方法\"><a class=\"anchor\" href=\"#懒汉式线程安全同步方法\">#</a> 懒汉式 (线程安全，同步方法)</h4>\n<pre><code>synchronized //效率低，不使用\n</code></pre>\n<h4 id=\"懒汉式线程安全同步代码块\"><a class=\"anchor\" href=\"#懒汉式线程安全同步代码块\">#</a> 懒汉式 (线程安全，同步代码块)</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Singleton02</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>instance <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token comment\">// 当多个现程进入后，即使一个个来，但是还是会选择创建，不使用</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token keyword\">synchronized</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Singleton02</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>                instance <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton02</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token keyword\">return</span> instance<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"双重检查\"><a class=\"anchor\" href=\"#双重检查\">#</a> 双重检查</h4>\n<pre><code>public static synchronized Singleton02 getInstance() &#123;\n        if (instance == null) &#123;\n            synchronized (Singleton02.class) &#123;\n                if (instance == null)\n                    instance = new Singleton02();\n            &#125;\n        &#125;\n        return instance;\n&#125;\n</code></pre>\n<h4 id=\"静态内部类\"><a class=\"anchor\" href=\"#静态内部类\">#</a> 静态内部类</h4>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">class</span> <span class=\"token class-name\">Singleton03</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 构造器私有化，外部不能 new</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Singleton03</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token comment\">// 当外部类被装载时，静态内部类并不会装载</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token comment\">// 当静态内部类装载时，是线程安全 (JVM 底层提供的机制)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SingletonInstance</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Singleton03</span> singleton <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Singleton03</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">synchronized</span> <span class=\"token class-name\">Singleton02</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Singleton02</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"枚举\"><a class=\"anchor\" href=\"#枚举\">#</a> 枚举</h4>\n<p>借助 JDK1.5 中添加的枚举类实现，不仅避免多线程同步问题，而且防止反序列化重新创建新的对象</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">enum</span> <span class=\"token class-name\">Singleton04</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token constant\">INSTANCE</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 属性</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">sayLove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"heart~\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h4 id=\"单例模式注意事项和细节说明\"><a class=\"anchor\" href=\"#单例模式注意事项和细节说明\">#</a> 单例模式注意事项和细节说明</h4>\n<ol>\n<li>单例模式保证了 系统内存中该类只存在一个对象，节省了系统资源，对于一些需要频繁创建销毁的对象，使用单例模式可以提高系统性能</li>\n<li>当想实例化一个单例类的时候，必须要记住使用相应的获取对象的方法，而不是使用 new</li>\n<li>单例模式使用的场景：需要频繁的进行创建和销毁的对象、创建对象时耗时过多或耗费资源过多 (即：重量级对象)，但又经常用到的对象、工具类对象、频繁访问数据库或文件的对象 (比如数据源、session 工厂等)</li>\n</ol>\n<h3 id=\"工厂设计模式\"><a class=\"anchor\" href=\"#工厂设计模式\">#</a> 工厂设计模式</h3>\n<h4 id=\"简单工厂\"><a class=\"anchor\" href=\"#简单工厂\">#</a> 简单工厂</h4>\n<h4 id=\"工厂方法\"><a class=\"anchor\" href=\"#工厂方法\">#</a> 工厂方法</h4>\n<h4 id=\"抽象工厂\"><a class=\"anchor\" href=\"#抽象工厂\">#</a> 抽象工厂</h4>\n",
            "tags": [
                "设计模式"
            ]
        },
        {
            "id": "http://example.com/2023/10/20/dp-normal/",
            "url": "http://example.com/2023/10/20/dp-normal/",
            "title": "dp_normal",
            "date_published": "2023-10-20T15:39:14.000Z",
            "content_html": "<p>今晚写了几题简单的动态规划。</p>\n<p>##70. 爬楼梯<br />\n假设你正在爬楼梯。需要 n 阶你才能到达楼顶。<br />\n每次你可以爬 1 或 2 个台阶。你有多少种不同的方法可以爬到楼顶呢？</p>\n<p>### 时间复杂度: O (N)<br />\n### 空间复杂度：用数组记录 O (n)， 用 p1, p2 循环 O (1)</p>\n<pre><code class=\"language-python3\">class Solution:\n    def climbStairs(self, n: int) -&gt; int:\n        #p[i] = p[i-1] + p[i-2]\n        if n==1:\n            return 1\n        if n==2:\n            return 2\n        # p = [0] * n\n        # p[0] = 1\n        # p[1] = 2\n        # for i in range(2, n):\n        #     p[i] = p[i-1] + p[i-2]\n        # return p[i]\n        p1 = 1\n        p2 = 2\n        for i in range(2, n):\n            p2, p1 = p2+p1, p2\n        return p2\n</code></pre>\n<p>##198. 打家劫舍<br />\n你是一个专业的小偷，计划偷窃沿街的房屋。每间房内都藏有一定的现金，影响你偷窃的唯一制约因素就是相邻的房屋装有相互连通的防盗系统，如果两间相邻的房屋在同一晚上被小偷闯入，系统会自动报警。<br />\n给定一个代表每个房屋存放金额的非负整数数组，计算你 不触动警报装置的情况下 ，一夜之内能够偷窃到的最高金额。</p>\n<p>### 时间复杂度: O (N)<br />\n### 空间复杂度：用数组记录 O (n)</p>\n<pre><code class=\"language-python3\">class Solution:\n    def rob(self, nums: List[int]) -&gt; int:\n        if len(nums)==1:\n            return nums[0]\n        if len(nums)==2:\n            return max(nums[0], nums[1])\n        # dp[i] = max(dp[i-1], dp[i-2]+nums[i])\n        dp = [0] * len(nums)\n        dp[0] = nums[0]\n        dp[1] = max(nums[0], nums[1])\n        for i in range(2, len(nums)):\n            dp[i] = max(dp[i-1], dp[i-2]+nums[i])\n        return dp[-1] \n</code></pre>\n<p>##139. 单词拆分<br />\n给你一个字符串 s 和一个字符串列表 wordDict 作为字典。请你判断是否可以利用字典中出现的单词拼接出 s 。</p>\n<p>注意：不要求字典中出现的单词全部都使用，并且字典中的单词可以重复使用。</p>\n<p>示例 1：<br />\n输入: s = &quot;leetcode&quot;, wordDict = [&quot;leet&quot;, &quot;code&quot;]<br />\n 输出: true<br />\n 解释：返回 true 因为 &quot;leetcode&quot; 可以由 &quot;leet&quot; 和 &quot;code&quot; 拼接成。</p>\n<p>### 时间复杂度: O (N2)* 字符串查找<br />\n ### 空间复杂度：用数组记录 O (n)</p>\n<pre><code class=\"language-Python3\">class Solution:\n    def wordBreak(self, s: str, wordDict: List[str]) -&gt; bool:\n        # dp[x] = &#123;dp[i] + isinword(s[i:x])&#125;\n        n = len(s)\n        # dp[i]表示s的前i位是否可以用wordDict中的单词表示\n        dp = [False] * (n+1)\n        # 初始化dp[0]=True，空字符可以被表示\n        dp[0] = True\n        for i in range(n):\n            for j in range(i+1, n+1):\n                if dp[i] and s[i:j] in wordDict:\n                    dp[j] = True\n        return dp[-1]\n</code></pre>\n",
            "tags": [
                "dp"
            ]
        }
    ]
}